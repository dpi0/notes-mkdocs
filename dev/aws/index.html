
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../arr-stack-home-server/" rel="prev"/>
<link href="../basics/" rel="next"/>
<link href="../../_changes/icons/favicon-32x32.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.48" name="generator"/>
<title>AWS - notes</title>
<link href="../../assets/stylesheets/main.6f8fc17f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Funnel+Sans:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Funnel Sans";--md-code-font:"JetBrains Mono"}</style>
<link href="../../_changes/css/styles.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#cli">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="notes" class="md-header__button md-logo" data-md-component="logo" href="../.." title="notes">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m7 21 7.9-18H17L9.1 21z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            notes
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              AWS
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="custom" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="custom" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="notes" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="notes">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m7 21 7.9-18H17L9.1 21z"></path></svg>
</a>
    notes
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2018/">
<span class="md-ellipsis">
    2018
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2019/">
<span class="md-ellipsis">
    2019
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2020/">
<span class="md-ellipsis">
    2020
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021/">
<span class="md-ellipsis">
    2021
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022/">
<span class="md-ellipsis">
    2022
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023/">
<span class="md-ellipsis">
    2023
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2024/">
<span class="md-ellipsis">
    2024
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Breakfast-Options/">
<span class="md-ellipsis">
    Breakfast Options
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Brilliance-of-The-Curse/">
<span class="md-ellipsis">
    Brilliance of The Curse
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Cardio-for-Fat-Loss/">
<span class="md-ellipsis">
    Cardio for Fat Loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Chachu-Home-Directions/">
<span class="md-ellipsis">
    Chachu Home Directions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Cooking-Oils/">
<span class="md-ellipsis">
    Cooking Oils
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Fat-Loss/">
<span class="md-ellipsis">
    Fat Loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Food-Science/">
<span class="md-ellipsis">
    Food Science
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Kanye-Unreleased-Untitled-Stream-Albums/">
<span class="md-ellipsis">
    Kanye Unreleased Untitled Stream Albums
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Old-IMDb-Movie-TV-Ratings/">
<span class="md-ellipsis">
    Old IMDb Movie-TV Ratings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Posture-Fix-Exercises/">
<span class="md-ellipsis">
    Posture Fix
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Short-Stories-Readlist/">
<span class="md-ellipsis">
    Short Stories Readlist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Soldering-Equipment/">
<span class="md-ellipsis">
    Soldering Equipment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Tips/">
<span class="md-ellipsis">
    Tips
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Youtube-playlists/">
<span class="md-ellipsis">
    Youtube Playlists
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Youtube-videos/">
<span class="md-ellipsis">
    YouTube videos to watch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cringe/">
<span class="md-ellipsis">
    Cringe
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../economic-systems/">
<span class="md-ellipsis">
    economic systems
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fabrics/">
<span class="md-ellipsis">
    List of Fabrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fitness/">
<span class="md-ellipsis">
    Fitness
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../human-anatomy/">
<span class="md-ellipsis">
    Human Anatomy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ideas/">
<span class="md-ellipsis">
    Ideas
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../indian-rivers/">
<span class="md-ellipsis">
    Indian Rivers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learned-from-youtube/">
<span class="md-ellipsis">
    Learned From Youtube
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lessons/">
<span class="md-ellipsis">
    lessons
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literary-devices/">
<span class="md-ellipsis">
    Literary Devices
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../memes/">
<span class="md-ellipsis">
    Memes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../punctuation/">
<span class="md-ellipsis">
    Punctuation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tab-stash-export/">
<span class="md-ellipsis">
    Tab Stash Export
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tags/">
<span class="md-ellipsis">
    Tags
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../todo-excel/">
<span class="md-ellipsis">
    Todo Excel
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../todo/">
<span class="md-ellipsis">
    todo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../up/">
<span class="md-ellipsis">
    up
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../watched-tv-films/">
<span class="md-ellipsis">
    Watched TV Films
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../why-some-cheap-protein-powders-exist/">
<span class="md-ellipsis">
    why some cheap protein powders exist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../words/">
<span class="md-ellipsis">
    Words
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_44" type="checkbox"/>
<label class="md-nav__link" for="__nav_44" id="__nav_44_label" tabindex="">
<span class="md-ellipsis">
    Books
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_44_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_44">
<span class="md-nav__icon md-icon"></span>
            Books
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/atomic-habits-james-clear/">
<span class="md-ellipsis">
    Atomic Habits - James Clear
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/how-to-avoid-a-climate-disaster-bill-gates/">
<span class="md-ellipsis">
    How to Avoid a Climate Disaster - Bill Gates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/understanding-the-mysteries-of-human-behaviour-mark-leary/">
<span class="md-ellipsis">
    Understanding the Mysteries of Human Behaviour - Mark Leary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_45" type="checkbox"/>
<label class="md-nav__link" for="__nav_45" id="__nav_45_label" tabindex="">
<span class="md-ellipsis">
    Dev
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_45_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_45">
<span class="md-nav__icon md-icon"></span>
            Dev
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Add-program-to-startup/">
<span class="md-ellipsis">
    Add program to startup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Available-dpi0-domain-names-on-hostinger/">
<span class="md-ellipsis">
    Available dpi0 domain names on hostinger
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../KVM/">
<span class="md-ellipsis">
    KVM
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../LUKS-Encryption/">
<span class="md-ellipsis">
    LUKS Encryption
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Push-Mirror-to-GitHub/">
<span class="md-ellipsis">
    Push Mirror to GitHub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SNAT-DNAT/">
<span class="md-ellipsis">
    SNAT DNAT
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../age-encryption-flow/">
<span class="md-ellipsis">
    Age Encryption Flow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ansible/">
<span class="md-ellipsis">
    Ansible
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/">
<span class="md-ellipsis">
    API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-desktop/">
<span class="md-ellipsis">
    Arch Desktop
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-home-server-apps/">
<span class="md-ellipsis">
    Arch Home Server Apps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-home-server-setup/">
<span class="md-ellipsis">
    dev/arch-home-server-setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-installation/">
<span class="md-ellipsis">
    Arch Installation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-server-manual-install/">
<span class="md-ellipsis">
    Arch Server Manual Install
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arr-stack-home-server/">
<span class="md-ellipsis">
    Arr Stack Home Server
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    AWS
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    AWS
  </span>
</a>
<nav aria-label="On this page" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      On this page
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#cli">
<span class="md-ellipsis">
      cli
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-instance">
<span class="md-ellipsis">
      setup instance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connect-instance">
<span class="md-ellipsis">
      connect instance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-ssh">
<span class="md-ellipsis">
      configure ssh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-docker">
<span class="md-ellipsis">
      setup docker
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get-lazydocker">
<span class="md-ellipsis">
      get lazydocker
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-wireguard">
<span class="md-ellipsis">
      setup wireguard
    </span>
</a>
<nav aria-label="setup wireguard" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#on-ec2">
<span class="md-ellipsis">
      on ec2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#on-client">
<span class="md-ellipsis">
      on client
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#to-route-my-traffic-to-the-internet">
<span class="md-ellipsis">
      to route my traffic to the internet
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-using-ec2-as-a-vpn-works">
<span class="md-ellipsis">
      why using ec2 as a vpn works?
    </span>
</a>
<nav aria-label="why using ec2 as a vpn works?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#routing-table-of-ec2">
<span class="md-ellipsis">
      routing table of ec2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#routing-table-of-arch">
<span class="md-ellipsis">
      routing table of arch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#to-create-a-central-server-and-connect-multiple-devices">
<span class="md-ellipsis">
      to create a central server and connect multiple devices
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-ec2-as-router-to-bypass-cgnat">
<span class="md-ellipsis">
      setup ec2 as router to bypass CGNAT
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../basics/">
<span class="md-ellipsis">
    Gti Basic Commands
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../best-practices/">
<span class="md-ellipsis">
    Best Practices
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../code-analysis/">
<span class="md-ellipsis">
    Code Analysis
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../conversions/">
<span class="md-ellipsis">
    File Conversions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../curl-wget/">
<span class="md-ellipsis">
    Curl Wget
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../custom-rom-old/">
<span class="md-ellipsis">
    Custom Rom Old
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../debian-apt-ppa/">
<span class="md-ellipsis">
    Debian/Ubuntu - APT PPA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns-records/">
<span class="md-ellipsis">
    DNS Records
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker-networks/">
<span class="md-ellipsis">
    Docker Networks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker/">
<span class="md-ellipsis">
    Docker
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dsa-problems/">
<span class="md-ellipsis">
    DSA Problems
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dsa-sorting/">
<span class="md-ellipsis">
    DSA Sorting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../emulation-games/">
<span class="md-ellipsis">
    Emulation Games
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../encrypted-dns/">
<span class="md-ellipsis">
    Encrypted DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fail2ban/">
<span class="md-ellipsis">
    fail2ban
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-compression-decompression/">
<span class="md-ellipsis">
    File Compression Decompression
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-encryption/">
<span class="md-ellipsis">
    File Encryption
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-hierarchy/">
<span class="md-ellipsis">
    File Hierarchy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-permissions/">
<span class="md-ellipsis">
    File Permissions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../firewall-nftables/">
<span class="md-ellipsis">
    Firewall Nftables
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-add/">
<span class="md-ellipsis">
    Git Add
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-branch-and-switch/">
<span class="md-ellipsis">
    Git Branch And Switch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-branching-stratergies/">
<span class="md-ellipsis">
    Git Branching Stratergies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-checkout/">
<span class="md-ellipsis">
    Git Checkout
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-cherry-pick/">
<span class="md-ellipsis">
    Git Cherry Pick
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-clean/">
<span class="md-ellipsis">
    Git Clean
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-commit/">
<span class="md-ellipsis">
    Git Commit
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-diff/">
<span class="md-ellipsis">
    Git Diff
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-fetch/">
<span class="md-ellipsis">
    Git Fetch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-hooks/">
<span class="md-ellipsis">
    Git Hooks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-init-and-bare/">
<span class="md-ellipsis">
    Git Init And Bare
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-merge/">
<span class="md-ellipsis">
    Git Merge
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-pull/">
<span class="md-ellipsis">
    Git Pull
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-push/">
<span class="md-ellipsis">
    Git Push
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-rebase/">
<span class="md-ellipsis">
    Git Rebase
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-reflog/">
<span class="md-ellipsis">
    Git Reflog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-remote/">
<span class="md-ellipsis">
    Git Remote
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-reset/">
<span class="md-ellipsis">
    Git Reset
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-revert/">
<span class="md-ellipsis">
    Git Revert
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-rm/">
<span class="md-ellipsis">
    Git Rm
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-show/">
<span class="md-ellipsis">
    Git Show
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-stash/">
<span class="md-ellipsis">
    Git Stash
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-status/">
<span class="md-ellipsis">
    Git Status
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-tag/">
<span class="md-ellipsis">
    Git Tag
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-worktree/">
<span class="md-ellipsis">
    Git Worktree
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../go/">
<span class="md-ellipsis">
    Go
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gpt-prompts/">
<span class="md-ellipsis">
    GPT Prompts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../graph/">
<span class="md-ellipsis">
    Graph
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../groups/">
<span class="md-ellipsis">
    Groups
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hard-soft-links/">
<span class="md-ellipsis">
    Hard Soft Links
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hardwarde-inspection/">
<span class="md-ellipsis">
    Hardwarde Inspection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../home-server-documentation/">
<span class="md-ellipsis">
    Home Server Documentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../https-ssl-tls-ca/">
<span class="md-ellipsis">
    HTTPs SSL TLS CA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../iem-buying-guide/">
<span class="md-ellipsis">
    IEM Buying Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactive-rebase/">
<span class="md-ellipsis">
    Interactive Rebase
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../intial-disk-setup/">
<span class="md-ellipsis">
    Intial Disk Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ip/">
<span class="md-ellipsis">
    Ip
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../journalctl/">
<span class="md-ellipsis">
    Journalctl
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../kubernetes/">
<span class="md-ellipsis">
    Kubernetes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../linux-tips/">
<span class="md-ellipsis">
    Linux Tips
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../low-end-games-list/">
<span class="md-ellipsis">
    Low End Games List
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../lxc/">
<span class="md-ellipsis">
    LXC
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../manage-docker-credentials/">
<span class="md-ellipsis">
    Manage Docker Credentials
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../managing-external-drives/">
<span class="md-ellipsis">
    Managing External Drives
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mb-vs-mib-marketing/">
<span class="md-ellipsis">
    Mb Vs Mib Marketing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../merge-conflicts/">
<span class="md-ellipsis">
    Merge Conflicts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../merge-strategies/">
<span class="md-ellipsis">
    Merge Strategies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../more-notes/">
<span class="md-ellipsis">
    More Notes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../netcat/">
<span class="md-ellipsis">
    Netcat
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../nginx-mkcert/">
<span class="md-ellipsis">
    Nginx Mkcert
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../nvim/">
<span class="md-ellipsis">
    Neovim
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ollama/">
<span class="md-ellipsis">
    Ollama
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pc-build-list/">
<span class="md-ellipsis">
    PC Build List
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pi-buying-guide/">
<span class="md-ellipsis">
    Pi Buying Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../powershell/">
<span class="md-ellipsis">
    Powershell
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../proton-vpn-wireguard/">
<span class="md-ellipsis">
    Proton VPN Wireguard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../proxychains-ng-tor/">
<span class="md-ellipsis">
    Proxychains-ng Tor
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-async/">
<span class="md-ellipsis">
    Py Async
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-concurrency/">
<span class="md-ellipsis">
    Py Concurrency
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-parallel-multi-async/">
<span class="md-ellipsis">
    Py Parallel Multi Async
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reboot-vs-logout/">
<span class="md-ellipsis">
    Reboot vs Logout
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../regex/">
<span class="md-ellipsis">
    Regex
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../restic-backup/">
<span class="md-ellipsis">
    Restic Backup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rhel-flow-centos/">
<span class="md-ellipsis">
    Rhel Flow Centos
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../roadmap/">
<span class="md-ellipsis">
    Roadmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../setup-arch-on-a-relatively-headless-machine/">
<span class="md-ellipsis">
    Setup Arch On A Relatively Headless Machine
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sudo/">
<span class="md-ellipsis">
    Sudo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-networkd-vs-networkmanager/">
<span class="md-ellipsis">
    Systemd Networkd Vs Networkmanager
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-service/">
<span class="md-ellipsis">
    Systemd Service
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-timer/">
<span class="md-ellipsis">
    Systemd Timer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd/">
<span class="md-ellipsis">
    Systemd
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tabs-vs-spaces/">
<span class="md-ellipsis">
    Tabs Vs Spaces
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../testing/">
<span class="md-ellipsis">
    Testing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tor-vs-free-vpn/">
<span class="md-ellipsis">
    TOR vs Free VPN
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../trigger-a-workflow-in-repo-B-from-repo-A-on-GitHub/">
<span class="md-ellipsis">
    How to trigger a workflow in repo-B from repo-A on GitHub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ubuntu-home-server-apps/">
<span class="md-ellipsis">
    Ubuntu Home Server Apps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ubuntu-home-server-install/">
<span class="md-ellipsis">
    Ubuntu Home Server Install
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../umask/">
<span class="md-ellipsis">
    Umask
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../undo/">
<span class="md-ellipsis">
    Undo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../useful-google-dorks/">
<span class="md-ellipsis">
    Useful Google Dorks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../useful-regex/">
<span class="md-ellipsis">
    Useful Regex
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../users/">
<span class="md-ellipsis">
    Users
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vagrant/">
<span class="md-ellipsis">
    Vagrant
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../veracrypt/">
<span class="md-ellipsis">
    Veracrypt
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../waydroid/">
<span class="md-ellipsis">
    Waydroid
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../windows-desktop/">
<span class="md-ellipsis">
    Windows Desktop
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yt-dlp-settings/">
<span class="md-ellipsis">
    yt-dlp Settings
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_46" type="checkbox"/>
<label class="md-nav__link" for="__nav_46" id="__nav_46_label" tabindex="">
<span class="md-ellipsis">
    Recipes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_46_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_46">
<span class="md-nav__icon md-icon"></span>
            Recipes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/Bhature/">
<span class="md-ellipsis">
    Bhature
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/Chicken-Korma/">
<span class="md-ellipsis">
    Chicken Korma
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/aachaari-aaloo/">
<span class="md-ellipsis">
    Aachaari Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/amritsari-chhole/">
<span class="md-ellipsis">
    Amritsari Chhole
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/bambino-vermicelli/">
<span class="md-ellipsis">
    Bambino Vermicelli
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/bhindi-or-beans-aaloo/">
<span class="md-ellipsis">
    Bhindi Or Beans Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-chaap/">
<span class="md-ellipsis">
    Butter Chaap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-chicken/">
<span class="md-ellipsis">
    Butter Chicken
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-paneer/">
<span class="md-ellipsis">
    Butter Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cabbage-aaloo/">
<span class="md-ellipsis">
    Cabbage Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cauliflower-aaloo/">
<span class="md-ellipsis">
    Cauliflower Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/chai/">
<span class="md-ellipsis">
    Chai
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cheese-masala-macaroni/">
<span class="md-ellipsis">
    Cheese Masala Macaroni
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cheese-sandwich/">
<span class="md-ellipsis">
    Cheese Sandwich
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/chilli-paneer/">
<span class="md-ellipsis">
    Chilli Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/egg-bhurji/">
<span class="md-ellipsis">
    Egg Bhurji
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/garam-masala/">
<span class="md-ellipsis">
    Garam Masala
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-chaap/">
<span class="md-ellipsis">
    Masala Chaap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-chicken/">
<span class="md-ellipsis">
    Masala Chicken
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-paneer/">
<span class="md-ellipsis">
    Masala Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-veg-oats/">
<span class="md-ellipsis">
    Masala Veg Oats
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/moong-masoor-daal/">
<span class="md-ellipsis">
    Moong Masoor Daal
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/omelette/">
<span class="md-ellipsis">
    Omelette
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/rajma/">
<span class="md-ellipsis">
    Rajma
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/rice/">
<span class="md-ellipsis">
    Rice
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/roti/">
<span class="md-ellipsis">
    Roti
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/simple-maggi/">
<span class="md-ellipsis">
    Simple Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/soya-chunks/">
<span class="md-ellipsis">
    Soya Chunks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/spicy-tomato-maggi/">
<span class="md-ellipsis">
    Spicy Tomato Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/tandoori-chicken-fry/">
<span class="md-ellipsis">
    Tandoori Chicken Fry
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/tomato-maggi/">
<span class="md-ellipsis">
    Tomato Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/veg-biriyani/">
<span class="md-ellipsis">
    Veg Biriyani
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/veggie-maggi/">
<span class="md-ellipsis">
    Veggie Maggi
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_47" type="checkbox"/>
<label class="md-nav__link" for="__nav_47" id="__nav_47_label" tabindex="">
<span class="md-ellipsis">
    Travel
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_47_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_47">
<span class="md-nav__icon md-icon"></span>
            Travel
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/best-places-in-delhi/">
<span class="md-ellipsis">
    Best Places In Delhi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/delhi-metro/">
<span class="md-ellipsis">
    Delhi Metro
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/places-to-see/">
<span class="md-ellipsis">
    Places To See
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/pvr-directions/">
<span class="md-ellipsis">
    Pvr Directions
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="On this page" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      On this page
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#cli">
<span class="md-ellipsis">
      cli
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-instance">
<span class="md-ellipsis">
      setup instance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#connect-instance">
<span class="md-ellipsis">
      connect instance
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-ssh">
<span class="md-ellipsis">
      configure ssh
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-docker">
<span class="md-ellipsis">
      setup docker
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#get-lazydocker">
<span class="md-ellipsis">
      get lazydocker
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-wireguard">
<span class="md-ellipsis">
      setup wireguard
    </span>
</a>
<nav aria-label="setup wireguard" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#on-ec2">
<span class="md-ellipsis">
      on ec2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#on-client">
<span class="md-ellipsis">
      on client
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#to-route-my-traffic-to-the-internet">
<span class="md-ellipsis">
      to route my traffic to the internet
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#why-using-ec2-as-a-vpn-works">
<span class="md-ellipsis">
      why using ec2 as a vpn works?
    </span>
</a>
<nav aria-label="why using ec2 as a vpn works?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#routing-table-of-ec2">
<span class="md-ellipsis">
      routing table of ec2
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#routing-table-of-arch">
<span class="md-ellipsis">
      routing table of arch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#to-create-a-central-server-and-connect-multiple-devices">
<span class="md-ellipsis">
      to create a central server and connect multiple devices
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setup-ec2-as-router-to-bypass-cgnat">
<span class="md-ellipsis">
      setup ec2 as router to bypass CGNAT
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<nav class="md-tags">
<a class="md-tag" href="../../tags/#aws">aws</a>
<a class="md-tag" href="../../tags/#linux">linux</a>
<a class="md-tag" href="../../tags/#guide">guide</a>
</nav>
<a class="md-content__button md-icon" href="https://github.com/dpi0/notes/edit/main/dev/aws.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v2h11V6zm0 4v2h11v-2zm17 .1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V20h2.1l6.1-6.1zM3 14v2h7v-2z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/dpi0/notes/raw/main/dev/aws.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.7 3.3S19.3 3 17.2 3c-5.5 0-15.6 2.1-14 17.8 1.1.1 2.2.2 3.2.2C24.3 21 20.7 3.3 20.7 3.3M7 17S7 7 17 7c0 0-6 2-10 10"></path></svg>
</a>
<h1><span class="enumerate-headings-plugin enumerate-heading-plugin">62.</span> AWS</h1>
<p><strong>PEM (Privacy Enhanced Mail) file</strong> is a container format used to store cryptographic information, such as public keys, private keys, certificates, and other cryptographic objects</p>
<p>PEM files can have various extensions, such as .pem, .crt, .cer, or .key.</p>
<p>file.pem can contain anything:</p>
<ul>
<li>a certificate with a public key</li>
<li>an SSH public key</li>
<li>public key + private key</li>
<li>certificate with a public key + private key</li>
</ul>
<p><strong>using the aws .pem file as the priv key:</strong></p>
<p>first check the default user of the instance from the console</p>
<div class="highlight"><pre><span></span><code>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/path/to/file.pem

ssh<span class="w"> </span>-i<span class="w"> </span><span class="s2">"~/.ssh/file.pem"</span><span class="w"> </span>default-user@xxxx.compute.amazonaws.com
</code></pre></div>
<p><strong>can extract pub key from pem file:</strong> <code>ssh-keygen -y -f file.pem &gt; file.pub</code></p>
<p>ppk is used for putty on windows: convert .pem &lt;--&gt; .ppk: https://repost.aws/knowledge-center/ec2-ppk-pem-conversion</p>
<p>https://dylancastillo.co/fastapi-nginx-gunicorn/</p>
<h2 id="cli"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.1</span> cli<a class="headerlink" href="#cli" title="Permanent link">¶</a></h2>
<p><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html">https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html</a></p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span><span class="s2">"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip"</span><span class="w"> </span>-o<span class="w"> </span><span class="s2">"awscliv2.zip"</span>
unzip<span class="w"> </span>awscliv2.zip
sudo<span class="w"> </span>./aws/install
</code></pre></div>
<h2 id="setup-instance"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.2</span> setup instance<a class="headerlink" href="#setup-instance" title="Permanent link">¶</a></h2>
<ul>
<li>
<p><strong>FIRST!</strong> create a <strong>custom</strong> security group</p>
</li>
<li>
<p>name it: "aws_server"</p>
</li>
<li>outbound: ALLOW ALL TRAFFIC</li>
<li>
<p>inbound: ALLOW custom <strong>3985</strong>/tcp, custom <strong>51900</strong>/udp, custom <strong>22</strong>/tcp, http <strong>80</strong>/tcp, https <strong>443</strong>/tcp</p>
</li>
<li>
<p>choose instance name</p>
</li>
<li>choose ubuntu 24.04</li>
<li>add a key pair (download the .pem file containing both private+public key)</li>
<li>select an exisiting security group: "aws_server"</li>
<li>change root volume size: 15G</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>free tier has 1GB IN and 100G OUT monthly, so be careful</p>
</div>
<h2 id="connect-instance"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.3</span> connect instance<a class="headerlink" href="#connect-instance" title="Permanent link">¶</a></h2>
<p><strong>NOTE:</strong> to remove an instance, terminate it and it'll go away automatically</p>
<div class="highlight"><pre><span></span><code>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>/path/to/key.pem
mv<span class="w"> </span>/path/to/key.pem<span class="w"> </span>~/.ssh/

ssh<span class="w"> </span>-i<span class="w"> </span>~/.ssh/key.pem<span class="w"> </span>ubuntu@ec2-xxxxxxxxx.compute.amazonaws.com
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>can point this instance's IP to *.duckdns.org via cron, <a href="https://www.duckdns.org/install.jsp">https://www.duckdns.org/install.jsp</a></p>
<p><strong>as the IP of ec2 instance keeps changing!</strong></p>
</div>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>~
mkdir<span class="w"> </span>duckdns
<span class="nb">cd</span><span class="w"> </span>duckdns
vi<span class="w"> </span>duck.sh

---

<span class="nb">echo</span><span class="w"> </span><span class="nv">url</span><span class="o">=</span><span class="s2">"https://www.duckdns.org/update?domains=awsdpi0&amp;token=xxxxxxxxxxxxx"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>curl<span class="w"> </span>-k<span class="w"> </span>-o<span class="w"> </span>~/duckdns/duck.log<span class="w"> </span>-K<span class="w"> </span>-

---

chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>duck.sh
<span class="nb">export</span><span class="w"> </span><span class="nv">EDITOR</span><span class="o">=</span>vim
crontab<span class="w"> </span>-e

---

*/5<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>*<span class="w"> </span>~/duckdns/duck.sh<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>

---

./duck.sh
cat<span class="w"> </span>duck.log
</code></pre></div>
<p><strong>connect</strong></p>
<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>-i<span class="w"> </span>~/.ssh/private-key.pem<span class="w"> </span>ubuntu@anything.duckdns.org
</code></pre></div>
<h2 id="configure-ssh"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.4</span> configure ssh<a class="headerlink" href="#configure-ssh" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">"t2micro"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/hostname

sudo<span class="w"> </span>passwd<span class="w"> </span><span class="nv">$USER</span>

sudo<span class="w"> </span>timedatectl<span class="w"> </span>set-timezone<span class="w"> </span>Asia/Kolkata
sudo<span class="w"> </span>timedatectl<span class="w"> </span>set-ntp<span class="w"> </span><span class="nb">true</span>
timedatectl
date

sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/ssh/sshd_config<span class="w"> </span><span class="s">&lt;&lt;EOF</span>
<span class="s">Port 3059</span>
<span class="s">PubkeyAuthentication yes</span>
<span class="s">PermitRootLogin no</span>
<span class="s">PasswordAuthentication no</span>
<span class="s">PermitEmptyPasswords no</span>
<span class="s">EOF</span>

sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>ssh
</code></pre></div>
<p><strong>use security groups on aws, the firewall</strong></p>
<ul>
<li>vpc --&gt; security groups --&gt; launch-wizard-4 (or whatever the name of your instance's group is) --&gt; edit inbound rules</li>
<li>delete all rules, add rule, <strong>3059/tcp</strong> and source <strong>anywhere-ip4/0.0.0.0/0</strong> can change this later for more privacy and can allow only my public ip to ssh into this</li>
<li>also open a port for wireguard --&gt; <strong>510000/udp</strong> and source <strong>anywhere-ip4/0.0.0.0/0</strong></li>
<li>reboot and check if public ip changed, most times instance doesn't require a reboot</li>
</ul>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>reboot<span class="w"> </span><span class="o">(</span>and<span class="w"> </span><span class="nb">wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>min<span class="w"> </span>or<span class="w"> </span>so<span class="o">)</span>
</code></pre></div>
<p><strong>now log back in</strong></p>
<div class="highlight"><pre><span></span><code>ssh<span class="w"> </span>-p<span class="w"> </span><span class="m">3059</span><span class="w"> </span>-i<span class="w"> </span>~/.ssh/private-key.pem<span class="w"> </span>ubuntu@anything.duckdns.org
</code></pre></div>
<h2 id="setup-docker"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.5</span> setup docker<a class="headerlink" href="#setup-docker" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
sudo<span class="w"> </span>reboot<span class="w"> </span>now

curl<span class="w"> </span>-fsSL<span class="w"> </span>https://get.docker.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh

sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
newgrp<span class="w"> </span>docker
groups<span class="w"> </span><span class="nv">$USER</span>
</code></pre></div>
<h2 id="get-lazydocker"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.6</span> get lazydocker<a class="headerlink" href="#get-lazydocker" title="Permanent link">¶</a></h2>
<p><a href="https://github.com/jesseduffield/lazydocker?tab=readme-ov-file#binary-release-linuxosxwindows">https://github.com/jesseduffield/lazydocker?tab=readme-ov-file#binary-release-linuxosxwindows</a></p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">'export PATH="$HOME/.local/bin:$PATH"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="nb">echo</span><span class="w"> </span><span class="s1">'alias ldd="lazydocker"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
<span class="nb">echo</span><span class="w"> </span><span class="s1">'alias ls="ls -lah"'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
curl<span class="w"> </span>https://raw.githubusercontent.com/jesseduffield/lazydocker/master/scripts/install_update_linux.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<span class="nb">source</span><span class="w"> </span><span class="nv">$HOME</span>/.bashrc
</code></pre></div>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://i.ibb.co/mD6s1d8/normally-using-ec2.png"><img src="https://i.ibb.co/mD6s1d8/normally-using-ec2.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<p>also check out [[aws-cli-v2-install]]</p>
<h2 id="setup-wireguard"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.7</span> setup wireguard<a class="headerlink" href="#setup-wireguard" title="Permanent link">¶</a></h2>
<ul>
<li><code>umask 077</code> sets current shell permissions like this: <code>rw</code> files <code>rwx</code> dir for <strong>user</strong>, none <strong>group</strong>, none <strong>others</strong></li>
<li><code>wg genkey</code> list just generates random string to be used as a key</li>
<li><code>wg pubkey</code> has to get an input from <code>wg genkey</code> as provided below by the T-splitter tee</li>
<li><code>ipv4.ip_forward</code> IP forwarding, also known as routing, is the process of moving packets from one network interface to another. system can pass network traffic from one network to another, essentially allowing it to function as a router. this is essential for vpn for passing traffic from one peer to another, not so much for home desktops.</li>
</ul>
<h3 id="on-ec2"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.7.1</span> on ec2<a class="headerlink" href="#on-ec2" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>wireguard<span class="w"> </span>-y
<span class="nb">echo</span><span class="w"> </span><span class="s2">"net.ipv4.ip_forward=1"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/sysctl.conf
sudo<span class="w"> </span>sysctl<span class="w"> </span>-p

<span class="nb">umask</span><span class="w"> </span><span class="m">077</span>
wg<span class="w"> </span>genkey<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>privatekey_wg0_server<span class="w"> </span><span class="p">|</span><span class="w"> </span>wg<span class="w"> </span>pubkey<span class="w"> </span>&gt;<span class="w"> </span>publickey_wg0_server

cat<span class="w"> </span>privatekey_wg0_server
cat<span class="w"> </span>publickey_wg0_server

sudo<span class="w"> </span>vim<span class="w"> </span>/etc/wireguard/wg0.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">[</span>Interface<span class="o">]</span>
<span class="nv">PrivateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;server<span class="err">'</span>s-private-key&gt;
<span class="nv">Address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.1/24
<span class="nv">ListenPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">51000</span>

<span class="o">[</span>Peer<span class="o">]</span>
<span class="nv">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;your-public-key&gt;<span class="w"> </span><span class="o">(</span>created<span class="w"> </span>next,<span class="w"> </span>paste<span class="w"> </span>here<span class="o">)</span>
<span class="nv">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.10/32
</code></pre></div>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>wg-quick<span class="w"> </span>up<span class="w"> </span>wg0
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>wg-quick@wg0

sudo<span class="w"> </span>wg
</code></pre></div>
<h3 id="on-client"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.7.2</span> on client<a class="headerlink" href="#on-client" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code><span class="nb">umask</span><span class="w"> </span><span class="m">077</span>
wg<span class="w"> </span>genkey<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>privatekey_wg0_client<span class="w"> </span><span class="p">|</span><span class="w"> </span>wg<span class="w"> </span>pubkey<span class="w"> </span>&gt;<span class="w"> </span>publickey_wg0_client

cat<span class="w"> </span>privatekey_wg0_client<span class="w"> </span><span class="p">|</span><span class="w"> </span>wl-copy
cat<span class="w"> </span>publickey_wg0_client<span class="w"> </span><span class="p">|</span><span class="w"> </span>wl-copy

sudo<span class="w"> </span>vim<span class="w"> </span>/etc/wireguard/wg0.conf
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="o">[</span>Interface<span class="o">]</span>
<span class="nv">PrivateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;your-private-key&gt;
<span class="nv">Address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.10/24

<span class="o">[</span>Peer<span class="o">]</span>
<span class="nv">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;server<span class="err">'</span>s-public-key&gt;
<span class="nv">Endpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>&lt;your-ec2-public-ip&gt;:51000
<span class="nv">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.0.0.0/0
<span class="nv">PersistentKeepalive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">25</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>peristentkeepalive ensures that the client sends a keepalive message to the server at regular intervals, regardless of whether there is actual data being transmitted through the VPN tunnel</p>
<p>client will send a keepalive packet every 25 seconds to the server.</p>
</div>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>wg-quick<span class="w"> </span>up<span class="w"> </span>wg0

sudo<span class="w"> </span>wg
ping<span class="w"> </span><span class="m">10</span>.0.0.1
</code></pre></div>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://i.ibb.co/b1BFBth/wg-basics.png"><img src="https://i.ibb.co/b1BFBth/wg-basics.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<p>following above, i can ping 10.0.0.1 and am connected to it locally</p>
<div class="highlight"><pre><span></span><code>rsync<span class="w"> </span>-havz<span class="w"> </span>--progress<span class="w"> </span>-e<span class="w"> </span><span class="s2">"ssh -p 3059 -i ~/.ssh/private-key.pem"</span><span class="w"> </span>nice.txt<span class="w"> </span>ubuntu@10.0.0.1:/home/ubuntu/
</code></pre></div>
<p>but i <strong>need to forward my traffic</strong> via the server to the internet</p>
<h2 id="to-route-my-traffic-to-the-internet"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.8</span> to route my traffic to the internet<a class="headerlink" href="#to-route-my-traffic-to-the-internet" title="Permanent link">¶</a></h2>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://i.ibb.co/x7RHQbh/using-ec2-as-vpn.png"><img src="https://i.ibb.co/x7RHQbh/using-ec2-as-vpn.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<div class="highlight"><pre><span></span><code>ip<span class="w"> </span>-c<span class="w"> </span>a

ip<span class="w"> </span>-c<span class="w"> </span>r
</code></pre></div>
<p>like <code>enX0</code> use this below</p>
<p><strong>on ec2, apply firewall rules</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ufw
sudo<span class="w"> </span>ufw<span class="w"> </span>disable
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>iptables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ip6tables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>arptables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ebtables

sudo<span class="w"> </span>iptables<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>raw<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>raw<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>security<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>security<span class="w"> </span>-X

sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>nftables
sudo<span class="w"> </span>nft<span class="w"> </span>list<span class="w"> </span>ruleset

sudo<span class="w"> </span>mv<span class="w"> </span>/etc/nftables.conf<span class="w"> </span>/etc/nftables.conf.bak
<span class="nb">echo</span><span class="w"> </span><span class="s1">'include "/etc/nftables.d/*.conf"'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/nftables.conf

sudo<span class="w"> </span>mkdir<span class="w"> </span>/etc/nftables.d/

sudo<span class="w"> </span>vim<span class="w"> </span>/etc/nftables.d/ec2_natrules.conf

sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nftables.service
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/sbin/nft -f</span>

table<span class="w"> </span>ip<span class="w"> </span>nat<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>prerouting<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>prerouting<span class="w"> </span>priority<span class="w"> </span>-100<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>input<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>output<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>output<span class="w"> </span>priority<span class="w"> </span>-100<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>postrouting<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>

<span class="w">        </span><span class="c1"># apply SNAT to my packets and the change the source IP of them to my Ip</span>
<span class="w">        </span>oif<span class="w"> </span><span class="s2">"enX0"</span><span class="w"> </span>masquerade

<span class="w">        </span>drop
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>Postrouting Chain: This chain is applied after routing decisions are made. In this configuration, it uses the masquerade rule to change the source address of outgoing packets to match the IP address of the outgoing interface (enX0).</p>
<p>use masquerade to modifies the source IP address of outgoing packets to match the IP address of the interface from which the packets are sent.</p>
<p>basically ec2 acts as a router now</p>
<p>When the masquerade rule is applied, it ensures that all outgoing traffic appears to originate from the public IP address of the router or gateway, allowing for proper routing back to the local devices. It effectively hides the internal network structure from external networks.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>wg-quick<span class="w"> </span>up<span class="w"> </span>wg0

ping<span class="w"> </span><span class="m">10</span>.0.0.1
ping<span class="w"> </span>google.com
curl<span class="w"> </span>ip.me
</code></pre></div>
<h2 id="why-using-ec2-as-a-vpn-works"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.9</span> why using ec2 as a vpn works?<a class="headerlink" href="#why-using-ec2-as-a-vpn-works" title="Permanent link">¶</a></h2>
<h3 id="routing-table-of-ec2"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.9.1</span> routing table of ec2<a class="headerlink" href="#routing-table-of-ec2" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code>default<span class="w"> </span>via<span class="w"> </span><span class="m">172</span>.31.32.1<span class="w"> </span>dev<span class="w"> </span>enX0<span class="w"> </span>proto<span class="w"> </span>dhcp<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.31.41.33<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>
<span class="m">10</span>.0.0.0/24<span class="w"> </span>dev<span class="w"> </span>wg0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">10</span>.0.0.1
<span class="m">172</span>.31.0.2<span class="w"> </span>via<span class="w"> </span><span class="m">172</span>.31.32.1<span class="w"> </span>dev<span class="w"> </span>enX0<span class="w"> </span>proto<span class="w"> </span>dhcp<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.31.41.33<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>
<span class="m">172</span>.31.32.0/20<span class="w"> </span>dev<span class="w"> </span>enX0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.31.41.33<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>
<span class="m">172</span>.31.32.1<span class="w"> </span>dev<span class="w"> </span>enX0<span class="w"> </span>proto<span class="w"> </span>dhcp<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.31.41.33<span class="w"> </span>metric<span class="w"> </span><span class="m">100</span>

---
<span class="m">10</span>.0.0.0/24<span class="w"> </span>dev<span class="w"> </span>wg0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">10</span>.0.0.1
</code></pre></div>
<div class="highlight"><pre><span></span><code>graph TD
    A[Default Route]
    B[10.0.0.0/24 Network]
    C[172.31.0.2 Host]
    D[172.31.32.0/20 Network]
    E[172.31.32.1 Host]

    A --&gt;|via 172.31.32.1| F[enX0]
    B --&gt;|direct| G[wg0]
    C --&gt;|via 172.31.32.1| F[enX0]
    D --&gt;|direct| F[enX0]
    E --&gt;|direct| F[enX0]

    F --&gt;|src 172.31.41.33| H[Internet/Other Networks]
    G --&gt;|src 10.0.0.1| I[10.0.0.0/24 Network]

    style A fill:#f9f,color:#000,stroke:#333,stroke-width:4px
    style B fill:#9f9,color:#000,stroke:#333,stroke-width:4px
    style C fill:#99f,color:#000,stroke:#333,stroke-width:4px
    style D fill:#ff9,color:#000,stroke:#333,stroke-width:4px
    style E fill:#9ff,color:#000,stroke:#333,stroke-width:4px
    style F fill:#f99,color:#000,stroke:#333,stroke-width:4px
    style G fill:#99f,color:#000,stroke:#333,stroke-width:4px
    style H fill:#9f9,color:#000,stroke:#333,stroke-width:4px
    style I fill:#ff9,color:#000,stroke:#333,stroke-width:4px
</code></pre></div>
<h3 id="routing-table-of-arch"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.9.2</span> routing table of arch<a class="headerlink" href="#routing-table-of-arch" title="Permanent link">¶</a></h3>
<p><strong>after wg0 is up, and connected to ec2</strong></p>
<div class="highlight"><pre><span></span><code>default<span class="w"> </span>via<span class="w"> </span><span class="m">192</span>.168.1.1<span class="w"> </span>dev<span class="w"> </span>wlp3s0<span class="w"> </span>proto<span class="w"> </span>static<span class="w"> </span>metric<span class="w"> </span><span class="m">600</span>
<span class="m">10</span>.0.0.0/24<span class="w"> </span>dev<span class="w"> </span>wg0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">10</span>.0.0.10
<span class="m">172</span>.17.0.0/16<span class="w"> </span>dev<span class="w"> </span>docker0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.17.0.1<span class="w"> </span>linkdown
<span class="m">172</span>.18.0.0/16<span class="w"> </span>dev<span class="w"> </span>br-cd86e03b405c<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.18.0.1<span class="w"> </span>linkdown
<span class="m">172</span>.22.0.0/16<span class="w"> </span>dev<span class="w"> </span>br-ae907093dda2<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">172</span>.22.0.1
<span class="m">192</span>.168.1.0/24<span class="w"> </span>dev<span class="w"> </span>wlp3s0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">192</span>.168.1.80<span class="w"> </span>metric<span class="w"> </span><span class="m">600</span>

---
<span class="m">10</span>.0.0.0/24<span class="w"> </span>dev<span class="w"> </span>wg0<span class="w"> </span>proto<span class="w"> </span>kernel<span class="w"> </span>scope<span class="w"> </span>link<span class="w"> </span>src<span class="w"> </span><span class="m">10</span>.0.0.10
</code></pre></div>
<div class="highlight"><pre><span></span><code>graph TD
    A[Default Route]
    B[10.0.0.0/24 Network]
    C[172.17.0.0/16 Network]
    D[172.18.0.0/16 Network]
    E[172.22.0.0/16 Network]
    F[192.168.1.0/24 Network]

    A --&gt;|via 192.168.1.1| G[wlp3s0]
    B --&gt;|direct| H[wg0]
    C --&gt;|direct| I[docker0]
    D --&gt;|direct| J[br-cd86e03b405c]
    E --&gt;|direct| K[br-ae907093dda2]
    F --&gt;|direct| G[wlp3s0]

    G --&gt;|src 192.168.1.80| L[Local Network/Internet]
    H --&gt;|src 10.0.0.10| M[10.0.0.0/24 Network]
    I --&gt;|src 172.17.0.1 linkdown| N[172.17.0.0/16 Network]
    J --&gt;|src 172.18.0.1 linkdown| O[172.18.0.0/16 Network]
    K --&gt;|src 172.22.0.1| P[172.22.0.0/16 Network]

    style A fill:#f9f,color:#000,stroke:#333,stroke-width:2px
    style B fill:#9f9,color:#000,stroke:#333,stroke-width:2px
    style C fill:#99f,color:#000,stroke:#333,stroke-width:2px
    style D fill:#ff9,color:#000,stroke:#333,stroke-width:2px
    style E fill:#9ff,color:#000,stroke:#333,stroke-width:2px
    style F fill:#f99,color:#000,stroke:#333,stroke-width:2px
    style G fill:#99f,color:#000,stroke:#333,stroke-width:2px
    style H fill:#9f9,color:#000,stroke:#333,stroke-width:2px
    style I fill:#ff9,color:#000,stroke:#333,stroke-width:2px
    style J fill:#9ff,color:#000,stroke:#333,stroke-width:2px
    style K fill:#f99,color:#000,stroke:#333,stroke-width:2px
    style L fill:#99f,color:#000,stroke:#333,stroke-width:2px
    style M fill:#9f9,color:#000,stroke:#333,stroke-width:2px
    style N fill:#ff9,color:#000,stroke:#333,stroke-width:2px
    style O fill:#9ff,color:#000,stroke:#333,stroke-width:2px
    style P fill:#f99,color:#000,stroke:#333,stroke-width:2px
</code></pre></div>
<p><strong>how am i able to access the internet via ec2?</strong></p>
<p>This works because the EC2 instance acts as both a <strong>VPN endpoint and a NAT gateway</strong>, enabling internet access for the VPN-connected client</p>
<p>and using the rule in the ip xyz table</p>
<div class="highlight"><pre><span></span><code>chain<span class="w"> </span>postrouting<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span>srcnat<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">    </span>oif<span class="w"> </span><span class="s2">"enX0"</span><span class="w"> </span>masquerade
<span class="w">    </span>drop
<span class="o">}</span>
</code></pre></div>
<p>ec2 is able to:</p>
<ol>
<li>sets the default postrouting policy to accept. If a packet does not match any rule in the chain, it is accepted and allowed to pass through.</li>
<li>changes the <strong>source</strong> packets of 10.0.0.10 to it's own output enX0 public interface's IP 172.31.41.200 using <strong>SNAT</strong></li>
<li>drop any packet that doesn't match the above rules</li>
</ol>
<p>in short <strong>arch --&gt; router --&gt; ISP --&gt; internet --&gt; ec2</strong></p>
<p>ISP can:</p>
<ul>
<li>see that you are sending and receiving data to and from the public IP address of the EC2 instance.</li>
<li>see the destination IP address of the EC2 instance's public interface (enX0) that you are connecting to.</li>
<li>volume of data, and the timing of the traffic.</li>
<li>ISP cannot see the contents of this traffic.</li>
<li>cannot see which websites you are visiting, the contents of your web requests, or any other sensitive information within the VPN tunnel.</li>
</ul>
<h3 id="to-create-a-central-server-and-connect-multiple-devices"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.9.3</span> to create a central server and connect multiple devices<a class="headerlink" href="#to-create-a-central-server-and-connect-multiple-devices" title="Permanent link">¶</a></h3>
<p><strong>on ec2 "central server"</strong></p>
<div class="highlight"><pre><span></span><code><span class="o">[</span>Interface<span class="o">]</span>
<span class="nv">ListenPort</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">51000</span>
<span class="nv">PrivateKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>OPW/C5IX5exxxxxxxxxxxxxxxxxxKR4Q7xxxxxYIIWA<span class="o">=</span>

<span class="o">[</span>Peer<span class="o">]</span>
<span class="nv">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">YwkJGoqxxxxxxxxxxxxxxxxxxxxYeNjbxxxxxxIj6IXE</span><span class="o">=</span>
<span class="nv">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.10/32

<span class="o">[</span>Peer<span class="o">]</span>
<span class="nv">PublicKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">D5FWTRxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxDjnCETA</span><span class="o">=</span>
<span class="nv">AllowedIPs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span>.0.0.100/32
</code></pre></div>
<p>now 10.0.0.10 and 10.0.0.100 can communicate <strong>as if they are locally connected.</strong> how cool is that!</p>
<h2 id="setup-ec2-as-router-to-bypass-cgnat"><span class="enumerate-headings-plugin enumerate-heading-plugin">62.10</span> setup ec2 as router to bypass CGNAT<a class="headerlink" href="#setup-ec2-as-router-to-bypass-cgnat" title="Permanent link">¶</a></h2>
<ul>
<li>connect home server to ec2 as above (no need to connect arch), ping from both ways 10.0.0.1 and 10.0.0.100</li>
<li>setup firewall on ec2</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>ports 443/ssh/wireguard must be open via security groups</p>
</div>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>ip<span class="w"> </span>NAT<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>PREROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>prerouting<span class="w"> </span>priority<span class="w"> </span>dstnat<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>iifname<span class="w"> </span><span class="s2">"enX0"</span><span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">80</span>,<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="o">}</span><span class="w"> </span>dnat<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.0.0.100:443
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>POSTROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span>srcnat<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>oifname<span class="w"> </span><span class="s2">"enX0"</span><span class="w"> </span>masquerade
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<ul>
<li>setup firewall on home server</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/sbin/nft -f</span>

flush<span class="w"> </span>ruleset

table<span class="w"> </span>ip<span class="w"> </span>FILTER<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>counter<span class="w"> </span>MY_COUNTER<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>INPUT<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>established,<span class="w"> </span>related<span class="w"> </span>accept
<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>invalid<span class="w"> </span>drop
<span class="w">        </span>iif<span class="w"> </span>lo<span class="w"> </span>accept
<span class="w">        </span>ip<span class="w"> </span>protocol<span class="w"> </span>icmp<span class="w"> </span>accept

<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>new<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="c1"># 2059,   # ssh</span>
<span class="w">            </span><span class="m">443</span>,<span class="w">    </span><span class="c1"># HTTPS</span>
<span class="w">            </span><span class="m">80</span>,<span class="w">     </span><span class="c1"># HTTP</span>
<span class="w">            </span><span class="c1"># 3000,   # gitea</span>
<span class="w">            </span><span class="c1"># 6969,   # adguard web interface</span>
<span class="w">            </span><span class="c1"># 2049,   # NFS</span>
<span class="w">        </span><span class="o">}</span><span class="w"> </span>counter<span class="w"> </span>name<span class="w"> </span>MY_COUNTER<span class="w"> </span>accept

<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>new<span class="w"> </span>udp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span>
<span class="w">            </span><span class="m">53</span><span class="w">      </span><span class="c1"># DNS</span>
<span class="w">        </span><span class="o">}</span><span class="w"> </span>accept

<span class="w">        </span>drop
<span class="w">        </span><span class="o">}</span>

<span class="c1">#   chain FORWARD {</span>
<span class="c1">#       type filter hook forward priority 0; policy drop;</span>
<span class="c1">#   }</span>

<span class="w">    </span>chain<span class="w"> </span>OUTPUT<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>output<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>established,<span class="w"> </span>related<span class="w"> </span>accept
<span class="w">        </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>                                                                                                 ┌───────────────────────────────────────┐
            ┌────────────────────────────────┐                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │                                                   │                                       │
            │                                │     ┌─────────────────────────────┐               │                                       │
            │                                │     │                             │               │                                       │
            │                                │     └─────────────────────────────┘               │                                       │
            │                                │                                                   │                                       │
            └────────────────────────────────┘                                                   │                                       │
                            ▲                                                                    │                                       │
                            │                                                                    │                                       │
                            │                                                                    │                                       │
                            │                                                                    │                                       │
                            │                 ┌──────────────────┐                               │                                       │
                            │                 │                  │                               │                                       │
                            │                 │                  │                               └───────────────────────────────────────┘
                            │                 │                  │
                            │                 │                  │
                            │                 │                  │
                            │                 │                  │
                            │                 │                  │
                            │                 │                  │
                            │                 │                  │
                            │                 └──────────────────┘
                            │
                            │
─────────◄──────────────────┘
</code></pre></div>
<ul>
<li>
<p>create a simple network in docker with caddy/ngnix + any services and allow port 443 in caddy config</p>
</li>
<li>
<p>so now you can hit the public ip/domain of the ec2 instance (as 443 is open on ec2 via security groups as well) on port 443/or any other port, that will be dnatted to the internal ip .1.100 of the home server on port 443 (open in above nftables config) and after home server replies back to 1.1 it's ttraffic gets snatted to be masqueraded as the public ip of ec2 to reach my endpoint arch/phone etc.</p>
</li>
</ul>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 1, 2024</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/dpi0" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="mailto:dpi0.dev@proton.me" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m15.24 8.998 3.656-3.073v15.81H2.482C1.11 21.735 0 20.609 0 19.223V6.944l7.58 6.38a2.186 2.186 0 0 0 2.871-.042l4.792-4.284zm-5.456 3.538 1.809-1.616a2.44 2.44 0 0 1-1.178-.533L.905 2.395A.552.552 0 0 0 0 2.826v2.811l8.226 6.923a1.186 1.186 0 0 0 1.558-.024M23.871 2.463a.55.55 0 0 0-.776-.068l-3.199 2.688v16.653h1.623c1.371 0 2.481-1.127 2.481-2.513V2.824a.55.55 0 0 0-.129-.36z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.view", "content.action.edit", "navigation.sections", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script src="../../js/open_in_new_tab.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>