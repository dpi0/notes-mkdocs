
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../file-permissions/" rel="prev"/>
<link href="../git-add/" rel="next"/>
<link href="../../_changes/icons/favicon-32x32.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.48" name="generator"/>
<title>Firewall Nftables - notes</title>
<link href="../../assets/stylesheets/main.6f8fc17f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Funnel+Sans:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Funnel Sans";--md-code-font:"JetBrains Mono"}</style>
<link href="../../_changes/css/styles.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></link></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#functions-of-a-firewall">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="notes" class="md-header__button md-logo" data-md-component="logo" href="../.." title="notes">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m7 21 7.9-18H17L9.1 21z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            notes
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Firewall Nftables
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9 2C5.13 2 2 5.13 2 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.87-3.13-7-7-7M6 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H6zm13-8h-2l-3.2 9h1.9l.7-2h3.2l.7 2h1.9zm-2.15 5.65L18 15l1.15 3.65z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="custom" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="custom" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="custom" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="notes" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="notes">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m7 21 7.9-18H17L9.1 21z"></path></svg>
</a>
    notes
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Home
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2018/">
<span class="md-ellipsis">
    2018
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2019/">
<span class="md-ellipsis">
    2019
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2020/">
<span class="md-ellipsis">
    2020
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2021/">
<span class="md-ellipsis">
    2021
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2022/">
<span class="md-ellipsis">
    2022
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2023/">
<span class="md-ellipsis">
    2023
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2024/">
<span class="md-ellipsis">
    2024
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Breakfast-Options/">
<span class="md-ellipsis">
    Breakfast Options
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Brilliance-of-The-Curse/">
<span class="md-ellipsis">
    Brilliance of The Curse
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Cardio-for-Fat-Loss/">
<span class="md-ellipsis">
    Cardio for Fat Loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Chachu-Home-Directions/">
<span class="md-ellipsis">
    Chachu Home Directions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Cooking-Oils/">
<span class="md-ellipsis">
    Cooking Oils
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Fat-Loss/">
<span class="md-ellipsis">
    Fat Loss
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Food-Science/">
<span class="md-ellipsis">
    Food Science
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Kanye-Unreleased-Untitled-Stream-Albums/">
<span class="md-ellipsis">
    Kanye Unreleased Untitled Stream Albums
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Old-IMDb-Movie-TV-Ratings/">
<span class="md-ellipsis">
    Old IMDb Movie-TV Ratings
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Posture-Fix-Exercises/">
<span class="md-ellipsis">
    Posture Fix
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Short-Stories-Readlist/">
<span class="md-ellipsis">
    Short Stories Readlist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Soldering-Equipment/">
<span class="md-ellipsis">
    Soldering Equipment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Tips/">
<span class="md-ellipsis">
    Tips
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Youtube-playlists/">
<span class="md-ellipsis">
    Youtube Playlists
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Youtube-videos/">
<span class="md-ellipsis">
    YouTube videos to watch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../cringe/">
<span class="md-ellipsis">
    Cringe
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../economic-systems/">
<span class="md-ellipsis">
    economic systems
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fabrics/">
<span class="md-ellipsis">
    List of Fabrics
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../fitness/">
<span class="md-ellipsis">
    Fitness
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../human-anatomy/">
<span class="md-ellipsis">
    Human Anatomy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../ideas/">
<span class="md-ellipsis">
    Ideas
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../indian-rivers/">
<span class="md-ellipsis">
    Indian Rivers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../learned-from-youtube/">
<span class="md-ellipsis">
    Learned From Youtube
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../lessons/">
<span class="md-ellipsis">
    lessons
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../literary-devices/">
<span class="md-ellipsis">
    Literary Devices
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../memes/">
<span class="md-ellipsis">
    Memes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../punctuation/">
<span class="md-ellipsis">
    Punctuation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tab-stash-export/">
<span class="md-ellipsis">
    Tab Stash Export
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tags/">
<span class="md-ellipsis">
    Tags
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../todo-excel/">
<span class="md-ellipsis">
    Todo Excel
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../todo/">
<span class="md-ellipsis">
    todo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../up/">
<span class="md-ellipsis">
    up
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../watched-tv-films/">
<span class="md-ellipsis">
    Watched TV Films
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../why-some-cheap-protein-powders-exist/">
<span class="md-ellipsis">
    why some cheap protein powders exist
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../words/">
<span class="md-ellipsis">
    Words
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_44" type="checkbox"/>
<label class="md-nav__link" for="__nav_44" id="__nav_44_label" tabindex="">
<span class="md-ellipsis">
    Books
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_44_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_44">
<span class="md-nav__icon md-icon"></span>
            Books
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/atomic-habits-james-clear/">
<span class="md-ellipsis">
    Atomic Habits - James Clear
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/how-to-avoid-a-climate-disaster-bill-gates/">
<span class="md-ellipsis">
    How to Avoid a Climate Disaster - Bill Gates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../books/understanding-the-mysteries-of-human-behaviour-mark-leary/">
<span class="md-ellipsis">
    Understanding the Mysteries of Human Behaviour - Mark Leary
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_45" type="checkbox"/>
<label class="md-nav__link" for="__nav_45" id="__nav_45_label" tabindex="">
<span class="md-ellipsis">
    Dev
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_45_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_45">
<span class="md-nav__icon md-icon"></span>
            Dev
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Add-program-to-startup/">
<span class="md-ellipsis">
    Add program to startup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Available-dpi0-domain-names-on-hostinger/">
<span class="md-ellipsis">
    Available dpi0 domain names on hostinger
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../KVM/">
<span class="md-ellipsis">
    KVM
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../LUKS-Encryption/">
<span class="md-ellipsis">
    LUKS Encryption
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Push-Mirror-to-GitHub/">
<span class="md-ellipsis">
    Push Mirror to GitHub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../SNAT-DNAT/">
<span class="md-ellipsis">
    SNAT DNAT
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../age-encryption-flow/">
<span class="md-ellipsis">
    Age Encryption Flow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ansible/">
<span class="md-ellipsis">
    Ansible
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/">
<span class="md-ellipsis">
    API
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-desktop/">
<span class="md-ellipsis">
    Arch Desktop
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-home-server-apps/">
<span class="md-ellipsis">
    Arch Home Server Apps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-home-server-setup/">
<span class="md-ellipsis">
    dev/arch-home-server-setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-installation/">
<span class="md-ellipsis">
    Arch Installation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arch-server-manual-install/">
<span class="md-ellipsis">
    Arch Server Manual Install
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../arr-stack-home-server/">
<span class="md-ellipsis">
    Arr Stack Home Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aws/">
<span class="md-ellipsis">
    AWS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../basics/">
<span class="md-ellipsis">
    Gti Basic Commands
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../best-practices/">
<span class="md-ellipsis">
    Best Practices
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../code-analysis/">
<span class="md-ellipsis">
    Code Analysis
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../conversions/">
<span class="md-ellipsis">
    File Conversions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../curl-wget/">
<span class="md-ellipsis">
    Curl Wget
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../custom-rom-old/">
<span class="md-ellipsis">
    Custom Rom Old
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../debian-apt-ppa/">
<span class="md-ellipsis">
    Debian/Ubuntu - APT PPA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns-records/">
<span class="md-ellipsis">
    DNS Records
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dns/">
<span class="md-ellipsis">
    DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker-networks/">
<span class="md-ellipsis">
    Docker Networks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../docker/">
<span class="md-ellipsis">
    Docker
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dsa-problems/">
<span class="md-ellipsis">
    DSA Problems
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../dsa-sorting/">
<span class="md-ellipsis">
    DSA Sorting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../emulation-games/">
<span class="md-ellipsis">
    Emulation Games
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../encrypted-dns/">
<span class="md-ellipsis">
    Encrypted DNS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../fail2ban/">
<span class="md-ellipsis">
    fail2ban
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-compression-decompression/">
<span class="md-ellipsis">
    File Compression Decompression
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-encryption/">
<span class="md-ellipsis">
    File Encryption
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-hierarchy/">
<span class="md-ellipsis">
    File Hierarchy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-permissions/">
<span class="md-ellipsis">
    File Permissions
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Firewall Nftables
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Firewall Nftables
  </span>
</a>
<nav aria-label="On this page" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      On this page
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#functions-of-a-firewall">
<span class="md-ellipsis">
      functions of a firewall
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#types-of-firewall">
<span class="md-ellipsis">
      types of firewall
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#popular-firewalls">
<span class="md-ellipsis">
      popular firewalls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nftables">
<span class="md-ellipsis">
      nftables
    </span>
</a>
<nav aria-label="nftables" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#vs-iptables">
<span class="md-ellipsis">
      vs. iptables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-the-firewall">
<span class="md-ellipsis">
      configure the firewall
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-ip-family">
<span class="md-ellipsis">
      the IP family
    </span>
</a>
<nav aria-label="the IP family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerouting">
<span class="md-ellipsis">
      PREROUTING
    </span>
</a>
<nav aria-label="PREROUTING" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#using-prerouting-for-a-simple-dnat">
<span class="md-ellipsis">
      using prerouting for a simple DNAT
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#postrouting">
<span class="md-ellipsis">
      POSTROUTING
    </span>
</a>
<nav aria-label="POSTROUTING" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-simple-router-prerouting-and-postrouting">
<span class="md-ellipsis">
      creating a simple router, prerouting and postrouting
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input">
<span class="md-ellipsis">
      INPUT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forward">
<span class="md-ellipsis">
      FORWARD
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#output">
<span class="md-ellipsis">
      OUTPUT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tables">
<span class="md-ellipsis">
      tables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chains">
<span class="md-ellipsis">
      chains
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hooks">
<span class="md-ellipsis">
      hooks
    </span>
</a>
<nav aria-label="hooks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ipv4ipv6inet-address-families-handle-ipv4-ipv6-or-both-types-of-packets">
<span class="md-ellipsis">
      IPv4/IPv6/Inet address families handle IPv4, IPv6 or both types of packets
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-address-family">
<span class="md-ellipsis">
      ARP address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bridge-address-family">
<span class="md-ellipsis">
      bridge address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#netdev-address-family">
<span class="md-ellipsis">
      Netdev address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#all-hook-priorities-and-their-aliases">
<span class="md-ellipsis">
      all hook priorities and their aliases
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rules">
<span class="md-ellipsis">
      rules
    </span>
</a>
<nav aria-label="rules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#add-a-rule-to-a-chain">
<span class="md-ellipsis">
      add a rule to a chain
    </span>
</a>
<nav aria-label="add a rule to a chain" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-handle-switch">
<span class="md-ellipsis">
      The --handle switch
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleting-a-rule-from-a-chain">
<span class="md-ellipsis">
      Deleting a rule from a chain
    </span>
</a>
<nav aria-label="Deleting a rule from a chain" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sets">
<span class="md-ellipsis">
      sets
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-family">
<span class="md-ellipsis">
      ARP Family
    </span>
</a>
<nav aria-label="ARP Family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-arp">
<span class="md-ellipsis">
      what is ARP?
    </span>
</a>
<nav aria-label="what is ARP?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-arp-works">
<span class="md-ellipsis">
      How ARP Works?
    </span>
</a>
<nav aria-label="How ARP Works?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-request">
<span class="md-ellipsis">
      ARP Request:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-reply">
<span class="md-ellipsis">
      ARP Reply:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scenario">
<span class="md-ellipsis">
      Scenario
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#steps">
<span class="md-ellipsis">
      Steps
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-table">
<span class="md-ellipsis">
      ARP Table
    </span>
</a>
<nav aria-label="ARP Table" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#allow-arp-requests-from-ip">
<span class="md-ellipsis">
      allow arp requests from ip
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#block-arp-replies">
<span class="md-ellipsis">
      block arp replies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#allow-icmp-echo-requests-from-know-mac-only">
<span class="md-ellipsis">
      allow ICMP echo requests from know MAC only
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-arp-requests">
<span class="md-ellipsis">
      log ARP requests
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iptables">
<span class="md-ellipsis">
      iptables
    </span>
</a>
<nav aria-label="iptables" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#adding-rules-to-tables">
<span class="md-ellipsis">
      adding rules to tables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleting-rules">
<span class="md-ellipsis">
      deleting rules
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-add/">
<span class="md-ellipsis">
    Git Add
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-branch-and-switch/">
<span class="md-ellipsis">
    Git Branch And Switch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-branching-stratergies/">
<span class="md-ellipsis">
    Git Branching Stratergies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-checkout/">
<span class="md-ellipsis">
    Git Checkout
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-cherry-pick/">
<span class="md-ellipsis">
    Git Cherry Pick
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-clean/">
<span class="md-ellipsis">
    Git Clean
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-commit/">
<span class="md-ellipsis">
    Git Commit
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-diff/">
<span class="md-ellipsis">
    Git Diff
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-fetch/">
<span class="md-ellipsis">
    Git Fetch
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-hooks/">
<span class="md-ellipsis">
    Git Hooks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-init-and-bare/">
<span class="md-ellipsis">
    Git Init And Bare
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-merge/">
<span class="md-ellipsis">
    Git Merge
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-pull/">
<span class="md-ellipsis">
    Git Pull
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-push/">
<span class="md-ellipsis">
    Git Push
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-rebase/">
<span class="md-ellipsis">
    Git Rebase
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-reflog/">
<span class="md-ellipsis">
    Git Reflog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-remote/">
<span class="md-ellipsis">
    Git Remote
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-reset/">
<span class="md-ellipsis">
    Git Reset
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-revert/">
<span class="md-ellipsis">
    Git Revert
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-rm/">
<span class="md-ellipsis">
    Git Rm
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-show/">
<span class="md-ellipsis">
    Git Show
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-stash/">
<span class="md-ellipsis">
    Git Stash
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-status/">
<span class="md-ellipsis">
    Git Status
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-tag/">
<span class="md-ellipsis">
    Git Tag
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../git-worktree/">
<span class="md-ellipsis">
    Git Worktree
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../go/">
<span class="md-ellipsis">
    Go
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gpt-prompts/">
<span class="md-ellipsis">
    GPT Prompts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../graph/">
<span class="md-ellipsis">
    Graph
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../groups/">
<span class="md-ellipsis">
    Groups
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hard-soft-links/">
<span class="md-ellipsis">
    Hard Soft Links
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hardwarde-inspection/">
<span class="md-ellipsis">
    Hardwarde Inspection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../home-server-documentation/">
<span class="md-ellipsis">
    Home Server Documentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../https-ssl-tls-ca/">
<span class="md-ellipsis">
    HTTPs SSL TLS CA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../iem-buying-guide/">
<span class="md-ellipsis">
    IEM Buying Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interactive-rebase/">
<span class="md-ellipsis">
    Interactive Rebase
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../intial-disk-setup/">
<span class="md-ellipsis">
    Intial Disk Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ip/">
<span class="md-ellipsis">
    Ip
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../journalctl/">
<span class="md-ellipsis">
    Journalctl
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../kubernetes/">
<span class="md-ellipsis">
    Kubernetes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../linux-tips/">
<span class="md-ellipsis">
    Linux Tips
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../low-end-games-list/">
<span class="md-ellipsis">
    Low End Games List
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../lxc/">
<span class="md-ellipsis">
    LXC
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../manage-docker-credentials/">
<span class="md-ellipsis">
    Manage Docker Credentials
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../managing-external-drives/">
<span class="md-ellipsis">
    Managing External Drives
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../mb-vs-mib-marketing/">
<span class="md-ellipsis">
    Mb Vs Mib Marketing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../merge-conflicts/">
<span class="md-ellipsis">
    Merge Conflicts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../merge-strategies/">
<span class="md-ellipsis">
    Merge Strategies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../more-notes/">
<span class="md-ellipsis">
    More Notes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../netcat/">
<span class="md-ellipsis">
    Netcat
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../nginx-mkcert/">
<span class="md-ellipsis">
    Nginx Mkcert
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../nvim/">
<span class="md-ellipsis">
    Neovim
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ollama/">
<span class="md-ellipsis">
    Ollama
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pc-build-list/">
<span class="md-ellipsis">
    PC Build List
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pi-buying-guide/">
<span class="md-ellipsis">
    Pi Buying Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../powershell/">
<span class="md-ellipsis">
    Powershell
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../proton-vpn-wireguard/">
<span class="md-ellipsis">
    Proton VPN Wireguard
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../proxychains-ng-tor/">
<span class="md-ellipsis">
    Proxychains-ng Tor
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-async/">
<span class="md-ellipsis">
    Py Async
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-concurrency/">
<span class="md-ellipsis">
    Py Concurrency
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../py-parallel-multi-async/">
<span class="md-ellipsis">
    Py Parallel Multi Async
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reboot-vs-logout/">
<span class="md-ellipsis">
    Reboot vs Logout
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../regex/">
<span class="md-ellipsis">
    Regex
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../restic-backup/">
<span class="md-ellipsis">
    Restic Backup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../rhel-flow-centos/">
<span class="md-ellipsis">
    Rhel Flow Centos
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../roadmap/">
<span class="md-ellipsis">
    Roadmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../setup-arch-on-a-relatively-headless-machine/">
<span class="md-ellipsis">
    Setup Arch On A Relatively Headless Machine
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sudo/">
<span class="md-ellipsis">
    Sudo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-networkd-vs-networkmanager/">
<span class="md-ellipsis">
    Systemd Networkd Vs Networkmanager
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-service/">
<span class="md-ellipsis">
    Systemd Service
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd-timer/">
<span class="md-ellipsis">
    Systemd Timer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../systemd/">
<span class="md-ellipsis">
    Systemd
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tabs-vs-spaces/">
<span class="md-ellipsis">
    Tabs Vs Spaces
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../testing/">
<span class="md-ellipsis">
    Testing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tor-vs-free-vpn/">
<span class="md-ellipsis">
    TOR vs Free VPN
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../trigger-a-workflow-in-repo-B-from-repo-A-on-GitHub/">
<span class="md-ellipsis">
    How to trigger a workflow in repo-B from repo-A on GitHub
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ubuntu-home-server-apps/">
<span class="md-ellipsis">
    Ubuntu Home Server Apps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ubuntu-home-server-install/">
<span class="md-ellipsis">
    Ubuntu Home Server Install
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../umask/">
<span class="md-ellipsis">
    Umask
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../undo/">
<span class="md-ellipsis">
    Undo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../useful-google-dorks/">
<span class="md-ellipsis">
    Useful Google Dorks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../useful-regex/">
<span class="md-ellipsis">
    Useful Regex
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../users/">
<span class="md-ellipsis">
    Users
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vagrant/">
<span class="md-ellipsis">
    Vagrant
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../veracrypt/">
<span class="md-ellipsis">
    Veracrypt
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../waydroid/">
<span class="md-ellipsis">
    Waydroid
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../windows-desktop/">
<span class="md-ellipsis">
    Windows Desktop
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../yt-dlp-settings/">
<span class="md-ellipsis">
    yt-dlp Settings
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_46" type="checkbox"/>
<label class="md-nav__link" for="__nav_46" id="__nav_46_label" tabindex="">
<span class="md-ellipsis">
    Recipes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_46_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_46">
<span class="md-nav__icon md-icon"></span>
            Recipes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/Bhature/">
<span class="md-ellipsis">
    Bhature
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/Chicken-Korma/">
<span class="md-ellipsis">
    Chicken Korma
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/aachaari-aaloo/">
<span class="md-ellipsis">
    Aachaari Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/amritsari-chhole/">
<span class="md-ellipsis">
    Amritsari Chhole
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/bambino-vermicelli/">
<span class="md-ellipsis">
    Bambino Vermicelli
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/bhindi-or-beans-aaloo/">
<span class="md-ellipsis">
    Bhindi Or Beans Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-chaap/">
<span class="md-ellipsis">
    Butter Chaap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-chicken/">
<span class="md-ellipsis">
    Butter Chicken
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/butter-paneer/">
<span class="md-ellipsis">
    Butter Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cabbage-aaloo/">
<span class="md-ellipsis">
    Cabbage Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cauliflower-aaloo/">
<span class="md-ellipsis">
    Cauliflower Aaloo
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/chai/">
<span class="md-ellipsis">
    Chai
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cheese-masala-macaroni/">
<span class="md-ellipsis">
    Cheese Masala Macaroni
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/cheese-sandwich/">
<span class="md-ellipsis">
    Cheese Sandwich
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/chilli-paneer/">
<span class="md-ellipsis">
    Chilli Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/egg-bhurji/">
<span class="md-ellipsis">
    Egg Bhurji
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/garam-masala/">
<span class="md-ellipsis">
    Garam Masala
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-chaap/">
<span class="md-ellipsis">
    Masala Chaap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-chicken/">
<span class="md-ellipsis">
    Masala Chicken
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-paneer/">
<span class="md-ellipsis">
    Masala Paneer
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/masala-veg-oats/">
<span class="md-ellipsis">
    Masala Veg Oats
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/moong-masoor-daal/">
<span class="md-ellipsis">
    Moong Masoor Daal
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/omelette/">
<span class="md-ellipsis">
    Omelette
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/rajma/">
<span class="md-ellipsis">
    Rajma
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/rice/">
<span class="md-ellipsis">
    Rice
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/roti/">
<span class="md-ellipsis">
    Roti
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/simple-maggi/">
<span class="md-ellipsis">
    Simple Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/soya-chunks/">
<span class="md-ellipsis">
    Soya Chunks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/spicy-tomato-maggi/">
<span class="md-ellipsis">
    Spicy Tomato Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/tandoori-chicken-fry/">
<span class="md-ellipsis">
    Tandoori Chicken Fry
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/tomato-maggi/">
<span class="md-ellipsis">
    Tomato Maggi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/veg-biriyani/">
<span class="md-ellipsis">
    Veg Biriyani
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../recipes/veggie-maggi/">
<span class="md-ellipsis">
    Veggie Maggi
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_47" type="checkbox"/>
<label class="md-nav__link" for="__nav_47" id="__nav_47_label" tabindex="">
<span class="md-ellipsis">
    Travel
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_47_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_47">
<span class="md-nav__icon md-icon"></span>
            Travel
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/best-places-in-delhi/">
<span class="md-ellipsis">
    Best Places In Delhi
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/delhi-metro/">
<span class="md-ellipsis">
    Delhi Metro
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/places-to-see/">
<span class="md-ellipsis">
    Places To See
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../travel/pvr-directions/">
<span class="md-ellipsis">
    Pvr Directions
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="On this page" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      On this page
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#functions-of-a-firewall">
<span class="md-ellipsis">
      functions of a firewall
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#types-of-firewall">
<span class="md-ellipsis">
      types of firewall
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#popular-firewalls">
<span class="md-ellipsis">
      popular firewalls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#nftables">
<span class="md-ellipsis">
      nftables
    </span>
</a>
<nav aria-label="nftables" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#vs-iptables">
<span class="md-ellipsis">
      vs. iptables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configure-the-firewall">
<span class="md-ellipsis">
      configure the firewall
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-ip-family">
<span class="md-ellipsis">
      the IP family
    </span>
</a>
<nav aria-label="the IP family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerouting">
<span class="md-ellipsis">
      PREROUTING
    </span>
</a>
<nav aria-label="PREROUTING" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#using-prerouting-for-a-simple-dnat">
<span class="md-ellipsis">
      using prerouting for a simple DNAT
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#postrouting">
<span class="md-ellipsis">
      POSTROUTING
    </span>
</a>
<nav aria-label="POSTROUTING" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#creating-a-simple-router-prerouting-and-postrouting">
<span class="md-ellipsis">
      creating a simple router, prerouting and postrouting
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#input">
<span class="md-ellipsis">
      INPUT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#forward">
<span class="md-ellipsis">
      FORWARD
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#output">
<span class="md-ellipsis">
      OUTPUT
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tables">
<span class="md-ellipsis">
      tables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#chains">
<span class="md-ellipsis">
      chains
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hooks">
<span class="md-ellipsis">
      hooks
    </span>
</a>
<nav aria-label="hooks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ipv4ipv6inet-address-families-handle-ipv4-ipv6-or-both-types-of-packets">
<span class="md-ellipsis">
      IPv4/IPv6/Inet address families handle IPv4, IPv6 or both types of packets
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-address-family">
<span class="md-ellipsis">
      ARP address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bridge-address-family">
<span class="md-ellipsis">
      bridge address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#netdev-address-family">
<span class="md-ellipsis">
      Netdev address family
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#all-hook-priorities-and-their-aliases">
<span class="md-ellipsis">
      all hook priorities and their aliases
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#rules">
<span class="md-ellipsis">
      rules
    </span>
</a>
<nav aria-label="rules" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#add-a-rule-to-a-chain">
<span class="md-ellipsis">
      add a rule to a chain
    </span>
</a>
<nav aria-label="add a rule to a chain" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-handle-switch">
<span class="md-ellipsis">
      The --handle switch
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleting-a-rule-from-a-chain">
<span class="md-ellipsis">
      Deleting a rule from a chain
    </span>
</a>
<nav aria-label="Deleting a rule from a chain" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#sets">
<span class="md-ellipsis">
      sets
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-family">
<span class="md-ellipsis">
      ARP Family
    </span>
</a>
<nav aria-label="ARP Family" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-is-arp">
<span class="md-ellipsis">
      what is ARP?
    </span>
</a>
<nav aria-label="what is ARP?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#how-arp-works">
<span class="md-ellipsis">
      How ARP Works?
    </span>
</a>
<nav aria-label="How ARP Works?" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-request">
<span class="md-ellipsis">
      ARP Request:
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-reply">
<span class="md-ellipsis">
      ARP Reply:
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#scenario">
<span class="md-ellipsis">
      Scenario
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#steps">
<span class="md-ellipsis">
      Steps
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#arp-table">
<span class="md-ellipsis">
      ARP Table
    </span>
</a>
<nav aria-label="ARP Table" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#allow-arp-requests-from-ip">
<span class="md-ellipsis">
      allow arp requests from ip
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#block-arp-replies">
<span class="md-ellipsis">
      block arp replies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#allow-icmp-echo-requests-from-know-mac-only">
<span class="md-ellipsis">
      allow ICMP echo requests from know MAC only
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-arp-requests">
<span class="md-ellipsis">
      log ARP requests
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#iptables">
<span class="md-ellipsis">
      iptables
    </span>
</a>
<nav aria-label="iptables" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#adding-rules-to-tables">
<span class="md-ellipsis">
      adding rules to tables
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deleting-rules">
<span class="md-ellipsis">
      deleting rules
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<nav class="md-tags">
<a class="md-tag" href="../../tags/#linux">linux</a>
<a class="md-tag" href="../../tags/#cli">cli</a>
<a class="md-tag" href="../../tags/#guide">guide</a>
</nav>
<a class="md-content__button md-icon" href="https://github.com/dpi0/notes/edit/main/dev/firewall-nftables.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v2h11V6zm0 4v2h11v-2zm17 .1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V20h2.1l6.1-6.1zM3 14v2h7v-2z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/dpi0/notes/raw/main/dev/firewall-nftables.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.7 3.3S19.3 3 17.2 3c-5.5 0-15.6 2.1-14 17.8 1.1.1 2.2.2 3.2.2C24.3 21 20.7 3.3 20.7 3.3M7 17S7 7 17 7c0 0-6 2-10 10"></path></svg>
</a>
<h1><span class="enumerate-headings-plugin enumerate-heading-plugin">1.</span> Firewall Nftables</h1>
<p>Firewalls use a set of rules to control traffic flow:</p>
<ul>
<li><strong>Rules:</strong> Define what traffic is allowed or denied. IP addresses, port numbers, protocols, or application types.</li>
<li><strong>Policies:</strong> collections of rules that define the overall behavior. "deny all" or "allow all." etc</li>
</ul>
<h2 id="functions-of-a-firewall"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.1</span> functions of a firewall<a class="headerlink" href="#functions-of-a-firewall" title="Permanent link">¶</a></h2>
<ul>
<li>monitors and controls incoming and outgoing network traffic based on predetermined security rules</li>
<li>acts as a barrier between a trusted internal network and untrusted external networks, such as the internet</li>
<li>examines all network traffic and permits or blocks data packets based on a set of security rules</li>
</ul>
<h2 id="types-of-firewall"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.2</span> types of firewall<a class="headerlink" href="#types-of-firewall" title="Permanent link">¶</a></h2>
<ul>
<li><strong>Packet-Filtering Firewalls:</strong> inspect packets at a low level, and make decisions based on predefined rules. source, destination IP addresses, ports, and protocols. simple fast. Limited in-depth inspection capabilities; cannot understand the context or content of the packets.</li>
<li><strong>Stateful Inspection Firewalls:</strong> tracks active connections and makes decisions based on the context of the traffic (whether the packet is part of an existing connection or a new one). More secure than packet-filtering firewalls as they maintain the state of connections. resource intensive.</li>
<li><strong>Application Layer Firewalls:</strong> operate at the application layer, inspecting the payload of the packets. like opensnitchd or malwarebytes firewall on windows. Can be slower due to the deep inspection of traffic.</li>
<li><strong>Proxy Firewalls:</strong> intermediaries between the user and the internet. latency. Can hide the internal network structure, provide anonymity</li>
<li><strong>e. Next-Generation Firewalls (NGFWs):</strong> traditional + intrusion prevention, application awareness, and deep packet inspection.</li>
</ul>
<h2 id="popular-firewalls"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.3</span> popular firewalls<a class="headerlink" href="#popular-firewalls" title="Permanent link">¶</a></h2>
<ul>
<li><strong>UFW</strong> (Uncomplicated Firewall) is a front-end for nftables (and iptables)</li>
<li><strong>iptables</strong> is outdated (part of the netfilter project)</li>
<li><strong>nftables</strong> is updated iptables, these days iptables commands just translate to nftables and execute nftables under the hood. offer more fine-grained control but can be complex.</li>
<li><strong>firewalld</strong> is overkill and a frontend to nftables (and, technically, iptables) Often used in Red Hat-based distributions fedora, centos. provides a more user-friendly experience with zones and dynamic management.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>so know about these two <strong>nftables</strong> first and then <strong>firewalld</strong> then later if needed for compatibility iftables.</p>
</div>
<h2 id="nftables"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.4</span> nftables<a class="headerlink" href="#nftables" title="Permanent link">¶</a></h2>
<p><strong>most importantly nftables is the ULTIMATE AUTHORITY on linux</strong> for firewall rules.</p>
<p><strong>so the docker port situation is under control</strong> as you can "open" any port on docker <strong>BUT nftables will be the one to actually provide access</strong></p>
<ul>
<li>successor of iptables</li>
<li>built on Netfilter and replaces the Netfilter infrastructure behind iptables, ip6tables, arptables, and ebtables.</li>
<li>future of firewalls on linux</li>
<li>iptables (IPv4), ip6tables (IPv6), arptables (ARP packets), and ebtables (Ethernet frames) command-line tools. Nftables <strong>replaces all four</strong> with a single command-line tool named <strong>nft</strong></li>
</ul>
<h3 id="vs-iptables"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.4.1</span> vs. iptables<a class="headerlink" href="#vs-iptables" title="Permanent link">¶</a></h3>
<ul>
<li>nftables do not have predefined tables or chains, which goes toward improving performance.</li>
<li>rules can take multiple actions, as opposed to iptables’ limitation to a single action per rule.</li>
<li>nftables comes with an inet address family that allows you to easily create tables that apply to both IPv4 and IPv6.</li>
<li>nftables’ ruleset is represented by a dynamic linked list, which improves the ruleset’s maintainability compared to iptables’ monolithic blob ruleset.</li>
<li>opens new options for structuring your ruleset, even allowing for multidimensional “tree” structures.</li>
</ul>
<p>to use exclusively nftables on arch/debian first disable iptables, ip6tables, arptables, ebtables AND ufw. nftables is meant to replace them all. so you don't need to touch anything else except this. <strong>nftables is the ultimate authority for firewalls on arch/debian</strong></p>
<p>nftables uses <code>/etc/nftables.conf</code> for all configurations. The nftables.service will load rules from that file when started or enabled.</p>
<h3 id="configure-the-firewall"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.4.2</span> configure the firewall<a class="headerlink" href="#configure-the-firewall" title="Permanent link">¶</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ufw
sudo<span class="w"> </span>ufw<span class="w"> </span>disable
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>iptables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ip6tables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>arptables
sudo<span class="w"> </span>systemctl<span class="w"> </span>disable<span class="w"> </span>--now<span class="w"> </span>ebtables

sudo<span class="w"> </span>iptables<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>nat<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>mangle<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>raw<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>raw<span class="w"> </span>-X
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>security<span class="w"> </span>-F
sudo<span class="w"> </span>iptables<span class="w"> </span>-t<span class="w"> </span>security<span class="w"> </span>-X
</code></pre></div>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>--now<span class="w"> </span>nftables
sudo<span class="w"> </span>nft<span class="w"> </span>list<span class="w"> </span>ruleset

sudo<span class="w"> </span>vim<span class="w"> </span>/etc/nftables.conf
</code></pre></div>
<ul>
<li>easiest way to add rules is to use <code>.nft</code> files and load them in</li>
<li>but first make a copy of the default file nftables reads from <code>sudo cp /etc/nftables.conf /etc/nftables.conf.bak</code></li>
<li><code>sudo vim /etc/mahrules.nft</code></li>
<li>each time you update your list, have to load the rules using <code>sudo nft -f /etc/mahrules.nft</code></li>
<li>then check ruleset <code>sudo nft list ruleset</code></li>
</ul>
<p>a better way to add modular files is using <code>.conf</code> files and loading them into <code>/etc/nftables.conf</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>mv<span class="w"> </span>/etc/nftables.conf<span class="w"> </span>/etc/nftables.conf.bak
<span class="nb">echo</span><span class="w"> </span><span class="s1">'include "/etc/nftables.d/*.conf"'</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/nftables.conf

sudo<span class="w"> </span>mkdir<span class="w"> </span>/etc/nftables.d/

sudo<span class="w"> </span>vim<span class="w"> </span>/etc/nftables.d/myrules.conf<span class="w"> </span><span class="c1"># OR copy a file there whatever!</span>

sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>nftables.service
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>when using iptables on modern linux, linux system is using the <code>iptables-nft</code> compatibility layer, which translates iptables commands to nftables rules.</p>
</div>
<p>Both iptables and nftables use the <strong>netfilter</strong> components in the Linux kernel.</p>
<p><strong>Rules</strong> are stored in <strong>chains</strong>, which in turn are stored in <strong>tables</strong></p>
<p>chain config is decided by <strong>hooks</strong></p>
<h2 id="the-ip-family"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5</span> the IP family<a class="headerlink" href="#the-ip-family" title="Permanent link">¶</a></h2>
<div class="highlight"><pre><span></span><code>graph TD
    A[INGRESS] --&gt; B[PREROUTING]
    B --&gt; C[ROUTING]
    C --&gt; D{Is packet destined for local machine?}
    D --&gt;|Yes| E[INPUT]
    E --&gt; F[Local Process]
    F --&gt; G[OUTPUT]
    G --&gt; H[POSTROUTING]
    D --&gt;|No, as this will act as a router| I[FORWARD]
    I --&gt; H

    style A fill:#f9f,color:#000,stroke:#333,stroke-width:2px
    style B fill:#f96,color:#000,stroke:#333,stroke-width:2px
    style C fill:#fc3,color:#000,stroke:#333,stroke-width:2px
    style D fill:#ff6,color:#000,stroke:#333,stroke-width:2px
    style E fill:#9f6,color:#000,stroke:#333,stroke-width:2px
    style F fill:#6f6,color:#000,stroke:#333,stroke-width:2px
    style G fill:#6f9,color:#000,stroke:#333,stroke-width:2px
    style H fill:#3f6,color:#000,stroke:#333,stroke-width:2px
    style I fill:#c6f,color:#000,stroke:#333,stroke-width:2px
</code></pre></div>
<p>simpler guide of tables chains hooks and rules<br/>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://i.ibb.co/1dmWsNd/tables-chains-hooks.png"><img src="https://i.ibb.co/1dmWsNd/tables-chains-hooks.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<p>this is the holy image for the stuff happening in here</p>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://people.netfilter.org/pablo/nf-hooks.png"><img src="https://people.netfilter.org/pablo/nf-hooks.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<h3 id="prerouting"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.1</span> PREROUTING<a class="headerlink" href="#prerouting" title="Permanent link">¶</a></h3>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://i.ibb.co/n1FV7bZ/ec2-snat-dnat-drawio-3.png"><img src="https://i.ibb.co/n1FV7bZ/ec2-snat-dnat-drawio-3.png"/></a><figcaption>image</figcaption>
</figure>
</p>
<p>prerouting happens after ingress, when packet first arrives at NIC (network interface) it hits the PREROUTING chain</p>
<p>PREROUTING can be used to modify packet headers, such as changing the destination address (DNAT).</p>
<p>After PREROUTING, the system makes routing decisions based on the potentially modified packet headers.</p>
<h4 id="using-prerouting-for-a-simple-dnat"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.1.1</span> using prerouting for a simple DNAT<a class="headerlink" href="#using-prerouting-for-a-simple-dnat" title="Permanent link">¶</a></h4>
<p>so here i can configure my "router" i.e home server to route packets headed to it on port :4040 by say my phone to a another device connected to it on say port :8080 hosting something.</p>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>ip<span class="w"> </span>NAT<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>PREROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">    </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>prerouting<span class="w"> </span>priority<span class="w"> </span>-100<span class="p">;</span>
<span class="w">    </span><span class="c1"># tcp dport 180 redirect to 2020;</span>
<span class="w">    </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">180</span><span class="w"> </span>dnat<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.1.80:2020

<span class="w">    </span><span class="c1"># you can even expose localhost services, something called martian packets, enable this `systctl -w net.ipv4.conf.all.route_localnet=1`</span>
<span class="w">    </span><span class="c1"># NOTE: this is not the best security practice, better ways to do this</span>
<span class="w">    </span><span class="c1"># tcp dport 180 dnat to 127.0.0.1:2020;</span>
<span class="w">    </span><span class="o">}</span>

<span class="o">}</span>
</code></pre></div>
<p><strong>uses are:</strong></p>
<ul>
<li><strong>DNAT/port forwarding,</strong> Used to redirect incoming traffic to a different IP address and/or port <code>nft add rule ip nat prerouting iifname "eth0" tcp dport 80 dnat to 192.168.1.100:8080</code></li>
<li><strong>transparent proxying</strong> Redirect outgoing traffic destined for the internet to a local proxy server. <code>nft add rule ip nat prerouting iifname "eth0" tcp dport 80 redirect to :3128</code></li>
<li><strong>load balancing:</strong> Distribute incoming traffic across multiple backend servers. <code>nft add rule ip nat prerouting iifname "eth0" tcp dport 80 dnat to 192.168.1.100:8080, 192.168.1.101:8080, 192.168.1.102:8080</code></li>
<li><strong>network redirection:</strong> Redirect traffic from one network to another. <code>nft add rule ip nat prerouting ip daddr 192.168.2.0/24 dnat to 192.168.3.0/24</code></li>
<li><strong>port translation:</strong> Translate ports for incoming traffic. Example: Translate incoming SSH traffic to a different port on the internal server. <code>nft add rule ip nat prerouting tcp dport 2222 dnat to 192.168.1.100:22</code></li>
</ul>
<h3 id="postrouting"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.2</span> POSTROUTING<a class="headerlink" href="#postrouting" title="Permanent link">¶</a></h3>
<p>It processes packets after the routing decision has been made but before the packet leaves the network interface</p>
<p>typically used for Source NAT (SNAT) and Masquerading.</p>
<p>after postrouting egress is hit.</p>
<p>After the system decides where to send the packet based on its destination, it passes through the POSTROUTING chain.</p>
<p>POSTROUTING can modify packet headers, such as changing the source address (SNAT).</p>
<p>After POSTROUTING, the packet is sent out through the designated network interface.</p>
<p><strong>uses:</strong></p>
<ul>
<li><strong>SNAT:</strong> Changes the source address of outgoing packets to a specific IP address. <code>nft add rule ip nat postrouting oifname "eth0" snat to 203.0.113.1</code></li>
</ul>
<div class="highlight"><pre><span></span><code>flush<span class="w"> </span>ruleset

table<span class="w"> </span>ip<span class="w"> </span>nat<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>POSTROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>oifname<span class="w"> </span>wlp2s0<span class="w"> </span>jump<span class="w"> </span>NAT_WLP2S0
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>NAT_WLP2S0<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="c1"># AUTO changes the source IP of the packet to that of the interface mentioned "wlp2s0"</span>
<span class="w">        </span>masquerade

<span class="w">        </span><span class="c1"># OR you can have more control over this and manually enter what the source IP should be</span>
<span class="w">        </span><span class="c1"># snat ip to 192.168.1.200</span>

<span class="w">        </span><span class="c1"># OR EVEN MORE, you can make sure traffic from a particular subnet can be SNATTED upon!</span>
<span class="w">        </span><span class="c1"># ip saddr 192.168.70.0/24 snat ip to 192.168.1.200</span>

<span class="w">        </span><span class="c1"># YOU CAN EVEN, allow SNATTING on a specific port from a specific subnet</span>
<span class="w">        </span><span class="c1"># but for that you should first allow all ports to SNATTED on (like here) and</span>
<span class="w">        </span><span class="c1"># THEN USE input table to block that/those ports like 80/443 etc</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<ul>
<li><strong>NAT POOLING</strong> <a href="https://youtu.be/qSM3c9cYNpY?list=PLUF494I4KUvqwDjhOoP3IFUpgEhE1OVDO&amp;t=729">https://youtu.be/qSM3c9cYNpY?list=PLUF494I4KUvqwDjhOoP3IFUpgEhE1OVDO&amp;t=729</a></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Important</p>
<p>Masquerading is just a special type of SNAT!</p>
</div>
<ul>
<li><strong>Masquerading:</strong> specific type of SNAT where the source address is changed to the IP address of the outgoing interface. It is often used for dynamic IP addresses. Example: Apply masquerading to packets leaving through the eth0 interface. <code>nft add rule ip nat postrouting oifname "eth0" masquerade</code></li>
<li><strong>Load Balancing:</strong> Modify the source address to ensure return packets go through the correct path, useful in multi-homed networks. Example: Apply SNAT to distribute outgoing traffic across multiple IP addresses. <code>nft add rule ip nat postrouting oifname "eth0" snat to 203.0.113.2-203.0.113.4</code></li>
<li><strong>Overlapping Networks:</strong> Resolve issues with overlapping IP ranges by modifying source addresses. Example: Change source IP for packets leaving to an overlapping network. <code>nft add rule ip nat postrouting oifname "eth1" snat to 10.0.0.1</code></li>
</ul>
<h4 id="creating-a-simple-router-prerouting-and-postrouting"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.2.1</span> creating a simple router, prerouting and postrouting<a class="headerlink" href="#creating-a-simple-router-prerouting-and-postrouting" title="Permanent link">¶</a></h4>
<p><strong>first enable ipv4 packet forwarding on the device</strong></p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">"net.ipv4.ip_forward=1"</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/sysctl.conf
sudo<span class="w"> </span>sysctl<span class="w"> </span>-p
</code></pre></div>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>ip<span class="w"> </span>NAT<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>PREROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>prerouting<span class="w"> </span>priority<span class="w"> </span>dstnat<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>iifname<span class="w"> </span>wlp2s0<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span><span class="m">80</span>,<span class="w"> </span><span class="m">443</span><span class="o">}</span><span class="w"> </span>dnat<span class="w"> </span>to<span class="w"> </span><span class="m">192</span>.168.1.80:2020<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>chain<span class="w"> </span>POSTROUTING<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span>srcnat<span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>accept<span class="p">;</span>
<span class="w">        </span>oifname<span class="w"> </span>wlp2s0<span class="w"> </span>masquerade
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h3 id="input"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.3</span> INPUT<a class="headerlink" href="#input" title="Permanent link">¶</a></h3>
<p>handles packets destined for the local system itself</p>
<p>used to control how incoming packets are processed <strong>before they are delivered to local applications or services.</strong></p>
<p>When a packet arrives at a network interface, it is first processed by the PREROUTING chain (if any NAT rules are to be applied). If the packet is destined for the local machine, it then goes to the INPUT chain</p>
<p>The default policy for the INPUT chain can be set to either accept or drop. This defines the default action for packets that do not match any rule.</p>
<p>Specific rules can be defined to allow, deny, log, or modify packets based on various criteria such as source address, destination address, protocol, port, etc.</p>
<p><strong>uses are:</strong></p>
<ul>
<li>Allowing or denying specific types of traffic to the local machine. <code>nft add rule ip filter input ip saddr 192.168.1.0/24 tcp dport 22 accept</code></li>
<li><strong>service access control</strong> <code>nft add rule ip filter input tcp dport { 80, 443 } accept</code></li>
<li><strong>logging</strong> log all dropped packets <code>nft add rule ip filter input drop log prefix "Dropped packet: "</code></li>
<li>Applying rate limits or logging incoming traffic. Example: Limit new SSH connections to 10 per minute from any single IP.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>ct<span class="w"> </span>state<span class="w"> </span>new<span class="w"> </span>limit<span class="w"> </span>rate<span class="w"> </span><span class="m">10</span>/minute<span class="w"> </span>burst<span class="w"> </span><span class="m">15</span><span class="w"> </span>packets<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>drop
</code></pre></div>
<h3 id="forward"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.4</span> FORWARD<a class="headerlink" href="#forward" title="Permanent link">¶</a></h3>
<p>handles packets that are routed through the system <strong>from one network interface to another</strong></p>
<p><strong>packets are not destined for the local machine but are simply passing through it.</strong></p>
<p><strong>FORWARD chain is critical for systems acting as routers or gateways, as it allows you to control and filter transit traffic</strong></p>
<p>When a packet arrives at a network interface and is destined for another network interface, it goes through the PREROUTING chain first (if NAT is applied), then the FORWARD chain, and finally the POSTROUTING chain.</p>
<p>The default policy for the FORWARD chain can be set to either accept or drop. This defines the default action for packets that do not match any rule.</p>
<p>Specific rules can be defined to allow, deny, log, or modify packets based on criteria such as source address, destination address, protocol, port, etc.</p>
<p><strong>uses are:</strong></p>
<ul>
<li><strong>Inter-Network Traffic Control:</strong> Example: Allow traffic between two internal subnets. <code>nft add rule ip filter forward ip saddr 192.168.1.0/24 ip daddr 10.0.0.0/24 accept</code></li>
<li><strong>internet access control:</strong> Control which internal machines can access the internet. Example: Allow only specific internal IPs to access the internet.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>forward<span class="w"> </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>oifname<span class="w"> </span><span class="s2">"eth0"</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>forward<span class="w"> </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="m">192</span>.168.1.101<span class="w"> </span>oifname<span class="w"> </span><span class="s2">"eth0"</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>forward<span class="w"> </span>oifname<span class="w"> </span><span class="s2">"eth0"</span><span class="w"> </span>drop
</code></pre></div>
<ul>
<li><strong>Firewall Between Networks:</strong> Implement firewall rules to block or permit traffic between different networks. Example: Block traffic from a specific subnet to another subnet.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>forward<span class="w"> </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="m">192</span>.168.1.0/24<span class="w"> </span>ip<span class="w"> </span>daddr<span class="w"> </span><span class="m">172</span>.16.0.0/24<span class="w"> </span>drop
</code></pre></div>
<ul>
<li><strong>Network Address Translation (NAT):</strong> Handle NAT for forwarded traffic, ensuring proper routing and address translation.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>table<span class="w"> </span>ip<span class="w"> </span>nat
nft<span class="w"> </span>add<span class="w"> </span>chain<span class="w"> </span>ip<span class="w"> </span>nat<span class="w"> </span>postrouting<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span>nat<span class="w"> </span>hook<span class="w"> </span>postrouting<span class="w"> </span>priority<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">}</span>
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>nat<span class="w"> </span>postrouting<span class="w"> </span>oifname<span class="w"> </span><span class="s2">"eth0"</span><span class="w"> </span>masquerade
</code></pre></div>
<h3 id="output"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.5</span> OUTPUT<a class="headerlink" href="#output" title="Permanent link">¶</a></h3>
<p>handles packets that originate from the local system and are sent out to the network</p>
<p>chain processes outbound traffic generated by local applications or services before it is transmitted over a network interface.</p>
<p>When a packet is created by a local process, it is first processed by the OUTPUT chain before being sent to the appropriate network interface.</p>
<p>default policy for the OUTPUT chain can be set to either accept or drop. This defines the default action for packets that do not match any rule.</p>
<p>Specific rules can be defined to allow, deny, log, or modify packets based on criteria such as destination address, destination port, protocol, etc.</p>
<p><strong>uses are:</strong></p>
<ul>
<li><strong>Controlling Outbound Traffic:</strong> Restrict or allow traffic based on destination addresses or ports.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">80</span>,<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="o">}</span><span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>drop
</code></pre></div>
<ul>
<li><strong>Service Access Control:</strong> Control which services on the local machine can initiate network connections. Example: Allow a web server to reach a database server.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>ip<span class="w"> </span>daddr<span class="w"> </span><span class="m">10</span>.0.0.5<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">5432</span><span class="w"> </span>accept
</code></pre></div>
<ul>
<li><strong>Logging</strong> Log outbound traffic for auditing and troubleshooting purposes.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>log<span class="w"> </span>prefix<span class="w"> </span><span class="s2">"Outbound SSH: "</span>
</code></pre></div>
<ul>
<li><strong>Rate Limiting:</strong> Limit the rate of outbound connections to prevent misuse or abuse of resources. Example: Limit the rate of outgoing HTTP requests to 20 per minute.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>limit<span class="w"> </span>rate<span class="w"> </span><span class="m">20</span>/minute<span class="w"> </span>burst<span class="w"> </span><span class="m">30</span><span class="w"> </span>packets<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>drop
</code></pre></div>
<h3 id="tables"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.6</span> tables<a class="headerlink" href="#tables" title="Permanent link">¶</a></h3>
<p>Tables hold Chains. Unlike tables in iptables, there are no built-in tables in nftables.</p>
<p>each table only has one address family and only applies to packets of this family.</p>
<table>
<thead>
<tr>
<th>nftables family</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ip</td>
<td>IPv4 address family.</td>
</tr>
<tr>
<td>ip6</td>
<td>IPv6 address family.</td>
</tr>
<tr>
<td>inet</td>
<td>Internet (IPv4/IPv6) address family.</td>
</tr>
<tr>
<td>arp</td>
<td>ARP address family, handling IPv4 ARP packets.</td>
</tr>
<tr>
<td>bridge</td>
<td>Bridge address family, handling packets which traverse a bridge device.</td>
</tr>
<tr>
<td>netdev</td>
<td>Netdev address family, handling packets on ingress and egress.</td>
</tr>
</tbody>
</table>
<p>ip (i.e. IPv4) is the default family and will be used if family is not specified.</p>
<p>To create one rule that applies to both IPv4 and IPv6, <strong>use inet</strong></p>
<ul>
<li><strong>create table</strong> <code>sudo nft add table family_type table_name</code></li>
<li><strong>list all tables</strong> <code>sudo nft list tables</code></li>
</ul>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>inet<span class="w"> </span>filter

table<span class="w"> </span>ip<span class="w"> </span>filter
table<span class="w"> </span>ip<span class="w"> </span>nat

table<span class="w"> </span>ip6<span class="w"> </span>filter
table<span class="w"> </span>ip6<span class="w"> </span>nat
</code></pre></div>
<ul>
<li><strong>list all chains and rules in a table</strong> <code>sudo nft list table family_type table_name</code> like <code>sudo nft list table ip nat</code></li>
<li><strong>delete table</strong> <code>sudo nft delete table family_type table_name</code> this will also remove all chains in that table</li>
<li><strong>clear/flush all rules from table</strong> <code>sudo nft flush table family_type table_name</code></li>
</ul>
<h3 id="chains"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.7</span> chains<a class="headerlink" href="#chains" title="Permanent link">¶</a></h3>
<p>purpose of chains is to hold Rules. Unlike chains in iptables, there are no built-in chains in nftables.</p>
<p>Chains have two types:</p>
<ul>
<li><strong>base chain</strong> is an entry point for packets from the networking stack, where a hook value is specified</li>
<li><strong>regular chain</strong> may be used as a jump target for better organization.</li>
</ul>
<p>supported chain types</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Families</th>
<th>Hooks</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>filter</td>
<td>all</td>
<td>all</td>
<td>Standard chain type to use in doubt.</td>
</tr>
<tr>
<td>nat</td>
<td>ip, ip6, inet</td>
<td>prerouting, input, output, postrouting</td>
<td>Chains of this type perform Native Address Translation based on conntrack entries. Only the first packet of a connection actually traverses this chain - its rules usually define details of the created conntrack entry (NAT statements for instance).</td>
</tr>
<tr>
<td>route</td>
<td>ip, ip6</td>
<td>output</td>
<td>If a packet has traversed a chain of this type and is about to be accepted, a new route lookup is performed if relevant parts of the IP header have changed. This allows one to e.g. implement policy routing selectors in nftables.</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>add chains</strong> <code>sudo nft add chain family_type table_name chain_name '{ type chain_type hook hook_type priority priority_value ; }'</code> chain_type can be filter, route, or nat.</li>
</ul>
<p>For IPv4/IPv6/Inet address families hook_type can be prerouting, input, forward, output, or postrouting</p>
<p>to add a base chain that filters input packets: <code>sudo nft add chain inet my_table my_chain '{ type filter hook input priority 0; }'</code></p>
<p>to add regular chain: <code>sudo nft add chain family_type table_name chain_name</code></p>
<ul>
<li><strong>list all rules in a chain</strong> <code>sudo nft list chain family_type table_name chain_name</code></li>
<li><strong>edit rules in a chain</strong> <code>sudo nft chain family_type table_name chain_name '{ [ type chain_type hook hook_type device device_name priority priority_value ; policy policy_type ; ] }'</code> like policy if chain my_input in default ip table <code>sudo nft chain inet my_table my_input '{ policy drop ; }'</code></li>
<li><strong>delete an empty chain</strong> <code>sudo nft delete chain family_type table_name chain_name</code></li>
<li><strong>delete/flush all rules from a chain</strong> <code>sudo nft flush chain family_type table_name chain_name</code></li>
</ul>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>add</td>
<td>Add a new chain in the specified table. When a hook and priority value are specified, the chain is created as a base chain and hooked up to the networking stack.</td>
</tr>
<tr>
<td>create</td>
<td>Similar to the add command, but returns an error if the chain already exists.</td>
</tr>
<tr>
<td>delete</td>
<td>Delete the specified chain. The chain must not contain any rules or be used as a jump target.</td>
</tr>
<tr>
<td>destroy</td>
<td>Delete the specified chain. It does not fail if it does not exist. The chain must not contain any rules or be used as a jump target.</td>
</tr>
<tr>
<td>rename</td>
<td>Rename the specified chain.</td>
</tr>
<tr>
<td>list</td>
<td>List all rules of the specified chain.</td>
</tr>
<tr>
<td>flush</td>
<td>Flush all rules of the specified chain.</td>
</tr>
</tbody>
</table>
<h3 id="hooks"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8</span> hooks<a class="headerlink" href="#hooks" title="Permanent link">¶</a></h3>
<h4 id="ipv4ipv6inet-address-families-handle-ipv4-ipv6-or-both-types-of-packets"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8.1</span> IPv4/IPv6/Inet address families handle IPv4, IPv6 or both types of packets<a class="headerlink" href="#ipv4ipv6inet-address-families-handle-ipv4-ipv6-or-both-types-of-packets" title="Permanent link">¶</a></h4>
<table>
<thead>
<tr>
<th>Hook</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>prerouting</td>
<td>All packets entering the system are processed by the prerouting hook. It is invoked before the routing process and is used for early filtering or changing packet attributes that affect routing.</td>
</tr>
<tr>
<td>input</td>
<td>Packets delivered to the local system are processed by the input hook.</td>
</tr>
<tr>
<td>forward</td>
<td>Packets forwarded to a different host are processed by the forward hook.</td>
</tr>
<tr>
<td>output</td>
<td>Packets sent by local processes are processed by the output hook.</td>
</tr>
<tr>
<td>postrouting</td>
<td>All packets leaving the system are processed by the postrouting hook.</td>
</tr>
<tr>
<td>ingress</td>
<td>All packets entering the system are processed by this hook. It is invoked before layer 3 protocol handlers, hence before the prerouting hook, and it can be used for filtering and policing. Ingress is only available for Inet family (since Linux kernel 5.10).</td>
</tr>
</tbody>
</table>
<h4 id="arp-address-family"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8.2</span> ARP address family<a class="headerlink" href="#arp-address-family" title="Permanent link">¶</a></h4>
<p>handles ARP packets received and sent by the system</p>
<table>
<thead>
<tr>
<th>Hook</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>input</td>
<td>Packets delivered to the local system are processed by the input hook.</td>
</tr>
<tr>
<td>output</td>
<td>Packets sent by the local system are processed by the output hook.</td>
</tr>
</tbody>
</table>
<h4 id="bridge-address-family"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8.3</span> bridge address family<a class="headerlink" href="#bridge-address-family" title="Permanent link">¶</a></h4>
<p>handles Ethernet packets traversing bridge devices</p>
<p>hooks are identical to IPv4/IPv6/Inet address families above</p>
<h4 id="netdev-address-family"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8.4</span> Netdev address family<a class="headerlink" href="#netdev-address-family" title="Permanent link">¶</a></h4>
<p>handles packets from the device ingress and egress path.</p>
<p>allows you to filter packets of any ethertype such as ARP, VLAN 802.1q, VLAN 802.1ad (Q-in-Q) as well as IPv4 and IPv6 packets.</p>
<table>
<thead>
<tr>
<th>Hook</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ingress</td>
<td>All packets entering the system are processed by this hook. It is invoked after network taps (e.g., tcpdump), right after tc ingress, and before layer 3 protocol handlers. It can be used for early filtering and policing.</td>
</tr>
<tr>
<td>egress</td>
<td>All packets leaving the system are processed by this hook. It is invoked after layer 3 protocol handlers and before tc egress. It can be used for late filtering and policing.</td>
</tr>
</tbody>
</table>
<p>order of netfilter and tc is mirrored on ingress versus egress. This ensures symmetry for NAT and other packet mangling.</p>
<h4 id="all-hook-priorities-and-their-aliases"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.8.5</span> all hook priorities and their aliases<a class="headerlink" href="#all-hook-priorities-and-their-aliases" title="Permanent link">¶</a></h4>
<table>
<thead>
<tr>
<th>nftables Families</th>
<th>Typical hooks</th>
<th>nft Keyword</th>
<th>Value</th>
<th>Netfilter Internal Priority</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>prerouting</td>
<td>-450</td>
<td>NF_IP_PRI_RAW_BEFORE_DEFRAG</td>
<td>inet, ip, ip6</td>
<td></td>
</tr>
<tr>
<td></td>
<td>prerouting</td>
<td>-400</td>
<td>NF_IP_PRI_CONNTRACK_DEFRAG</td>
<td>inet, ip, ip6</td>
<td>Packet defragmentation / datagram reassembly</td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>all</td>
<td>raw</td>
<td>-300</td>
<td>NF_IP_PRI_RAW</td>
<td>Traditional priority of the raw table placed before connection tracking operation</td>
</tr>
<tr>
<td></td>
<td></td>
<td>-225</td>
<td>NF_IP_PRI_SELINUX_FIRST</td>
<td>SELinux operations</td>
<td></td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>prerouting, output</td>
<td>-200</td>
<td>NF_IP_PRI_CONNTRACK</td>
<td>Connection tracking processes run early in prerouting and output hooks to associate packets with tracked connections.</td>
<td></td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>all</td>
<td>mangle</td>
<td>-150</td>
<td>NF_IP_PRI_MANGLE</td>
<td>Mangle operation</td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>prerouting</td>
<td>dstnat</td>
<td>-100</td>
<td>NF_IP_PRI_NAT_DST</td>
<td>Destination NAT</td>
</tr>
<tr>
<td>inet, ip, ip6, arp, netdev</td>
<td>all</td>
<td>filter</td>
<td>0</td>
<td>NF_IP_PRI_FILTER</td>
<td>Filtering operation, the filter table</td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>all</td>
<td>security</td>
<td>50</td>
<td>NF_IP_PRI_SECURITY</td>
<td>Place of security table, where secmark can be set for example</td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>postrouting</td>
<td>srcnat</td>
<td>100</td>
<td>NF_IP_PRI_NAT_SRC</td>
<td>Source NAT</td>
</tr>
<tr>
<td></td>
<td>postrouting</td>
<td>225</td>
<td>NF_IP_PRI_SELINUX_LAST</td>
<td>SELinux at packet exit</td>
<td></td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>postrouting</td>
<td>300</td>
<td>NF_IP_PRI_CONNTRACK_HELPER</td>
<td>Connection tracking helpers, which identify expected and related packets.</td>
<td></td>
</tr>
<tr>
<td>inet, ip, ip6</td>
<td>input, postrouting</td>
<td>INT_MAX</td>
<td>NF_IP_PRI_CONNTRACK_CONFIRM</td>
<td>Connection tracking adds new tracked connections at final step in input &amp; postrouting hooks.</td>
<td></td>
</tr>
</tbody>
</table>
<p>| bridge | prerouting | dstnat | -300 | NF_BR_PRI_NAT_DST_BRIDGED | Starting point for bridge family |<br/>
| bridge | all | filter | -200 | NF_BR_PRI_FILTER_BRIDGED | Filter table for the bridge family |<br/>
| bridge | | 0 | NF_BR_PRI_BRNF | Default starting priority for bridge family |<br/>
| bridge | output | out | 100 | NF_BR_PRI_NAT_DST_OTHER | Destination NAT for non-bridged traffic |<br/>
| bridge | | 200 | NF_BR_PRI_FILTER_OTHER | Filter operations for non-bridged traffic |<br/>
| bridge | postrouting | srcnat | 300 | NF_BR_PRI_NAT_SRC | Source NAT for bridge traffic |</p>
<h3 id="rules"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.9</span> rules<a class="headerlink" href="#rules" title="Permanent link">¶</a></h3>
<p>Rules are either constructed from expressions or statements and are contained within chains.</p>
<p>Internally, rule locations are always identified by handle and the translation from index happens in userspace</p>
<p>A comment is a single word or a double-quoted (") multi-word string which can be used to make notes regarding the actual rule.</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>add</td>
<td>Add a new rule described by the list of statements. The rule is appended to the given chain unless a location is specified, in which case the rule is inserted after the specified rule.</td>
</tr>
<tr>
<td>insert</td>
<td>Same as add, except the rule is inserted at the beginning of the chain or before the specified rule.</td>
</tr>
<tr>
<td>replace</td>
<td>Similar to add, but the rule replaces the specified rule.</td>
</tr>
<tr>
<td>delete</td>
<td>Delete the specified rule.</td>
</tr>
<tr>
<td>destroy</td>
<td>Delete the specified rule. It does not fail if it does not exist.</td>
</tr>
<tr>
<td>reset</td>
<td>Reset rule-contained state, e.g., counter and quota statement values.</td>
</tr>
</tbody>
</table>
<h4 id="add-a-rule-to-a-chain"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.9.1</span> add a rule to a chain<a class="headerlink" href="#add-a-rule-to-a-chain" title="Permanent link">¶</a></h4>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>family_type<span class="w"> </span>table_name<span class="w"> </span>chain_name<span class="w"> </span>handle<span class="w"> </span>handle_value<span class="w"> </span>statement

sudo<span class="w"> </span>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>ip<span class="w"> </span>daddr<span class="w"> </span><span class="m">192</span>.168.0.0/24<span class="w"> </span>accept<span class="w"> </span><span class="c1"># 'ip filter' is assumed</span>
sudo<span class="w"> </span>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>output<span class="w"> </span>ip<span class="w"> </span>daddr<span class="w"> </span><span class="m">192</span>.168.0.0/24<span class="w"> </span>accept
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>here the rule is appended at handle_value, which is optional. If not specified, the rule is appended to the end of the chain.</p>
</div>
<h5 id="the-handle-switch"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.5.9.1.1</span> The --handle switch<a class="headerlink" href="#the-handle-switch" title="Permanent link">¶</a></h5>
<p>can be added to any valid list command, must be used to determine a rule handle.</p>
<p>This switch tells nft to list the handles in its output</p>
<div class="highlight"><pre><span></span><code>table<span class="w"> </span>inet<span class="w"> </span>my_table<span class="w"> </span><span class="o">{</span>
<span class="w">     </span>chain<span class="w"> </span>input<span class="w"> </span><span class="o">{</span>
<span class="w">          </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">          </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>accept<span class="w"> </span><span class="c1"># handle 10</span>
<span class="w">     </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p><strong>to prepend a rule to the position of the specified handle</strong> <code>sudo nft insert rule family_type table_name chain_name handle handle_value statement</code></p>
<div class="admonition note">
<p class="admonition-title">&gt; <strong>Important:</strong> When adding a rule to a chain:</p>
<ul>
<li>If <code>handle_value</code> is not specified, the rule is <strong>prepended</strong> to the chain.</li>
</ul>
</div>
<h2 id="deleting-a-rule-from-a-chain"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.6</span> Deleting a rule from a chain<a class="headerlink" href="#deleting-a-rule-from-a-chain" title="Permanent link">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul>
<li>Individual rules can <strong>only</strong> be deleted by their <strong>handles</strong>.</li>
</ul>
<p><strong>Make sure to note the handle of the rule you want to delete.</strong></p>
</div>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nft<span class="w"> </span>--handle<span class="w"> </span>--numeric<span class="w"> </span>list<span class="w"> </span>chain<span class="w"> </span>inet<span class="w"> </span>my_table<span class="w"> </span>my_input

---

table<span class="w"> </span>inet<span class="w"> </span>my_table<span class="w"> </span><span class="o">{</span>
<span class="w">     </span>chain<span class="w"> </span>input<span class="w"> </span><span class="o">{</span>
<span class="w">          </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span>
<span class="w">          </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>accept<span class="w"> </span><span class="c1"># handle 10</span>
<span class="w">     </span><span class="o">}</span>
<span class="o">}</span>

---

sudo<span class="w"> </span>nft<span class="w"> </span>delete<span class="w"> </span>rule<span class="w"> </span>inet<span class="w"> </span>my_table<span class="w"> </span>my_input<span class="w"> </span>handle<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<h3 id="sets"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.6.1</span> sets<a class="headerlink" href="#sets" title="Permanent link">¶</a></h3>
<p>nftables offers two kinds of set concepts:</p>
<ul>
<li><strong>Anonymous sets</strong> are sets that have no specific name. The set members are enclosed in curly braces, with commas to separate elements when creating the rule the set is used in. <code>{ 10.0.0.0/8, 192.168.0.0/16 }</code> Once that rule is removed, the set is removed as well. They cannot be updated, i.e. once an anonymous set is declared it cannot be changed anymore except by removing/altering the rule that uses the anonymous set.</li>
</ul>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>ip<span class="w"> </span>saddr<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">10</span>.0.0.0/8,<span class="w"> </span><span class="m">192</span>.168.0.0/16<span class="w"> </span><span class="o">}</span><span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span><span class="o">{</span><span class="w"> </span><span class="m">22</span>,<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="o">}</span><span class="w"> </span>accept
</code></pre></div>
<ul>
<li><strong>Named sets</strong> are sets that need to be defined first before they can be referenced in rules. Unlike anonymous sets, elements can be added to or removed from a named set at any time. Sets are referenced from rules using an @ prefixed to the sets name.</li>
</ul>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>ip<span class="w"> </span>saddr<span class="w"> </span>@allowed_hosts<span class="w"> </span>tcp<span class="w"> </span>dport<span class="w"> </span>@allowed_ports<span class="w"> </span>accept
</code></pre></div>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>add</td>
<td>Add a new set in the specified table. See the Set specification table below for more information about how to specify properties of a set.</td>
</tr>
<tr>
<td>delete</td>
<td>Delete the specified set.</td>
</tr>
<tr>
<td>destroy</td>
<td>Delete the specified set. It does not fail if it does not exist.</td>
</tr>
<tr>
<td>list</td>
<td>Display the elements in the specified set.</td>
</tr>
<tr>
<td>flush</td>
<td>Remove all elements from the specified set.</td>
</tr>
<tr>
<td>reset</td>
<td>Reset state in all contained elements, e.g., counter and quota statement values.</td>
</tr>
</tbody>
</table>
<p>set specifications</p>
<table>
<thead>
<tr>
<th>Keyword</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>Data type of set elements</td>
<td>string: ipv4_addr, ipv6_addr, ether_addr, inet_proto, inet_service, mark</td>
</tr>
<tr>
<td>typeof</td>
<td>Data type of set element</td>
<td>expression to derive the data type from</td>
</tr>
<tr>
<td>flags</td>
<td>Set flags</td>
<td>string: constant, dynamic, interval, timeout. Used to describe the set's properties.</td>
</tr>
<tr>
<td>timeout</td>
<td>Time an element stays in the set, mandatory if set is added to from the packet path (ruleset)</td>
<td>string, decimal followed by unit. Units are: d, h, m, s</td>
</tr>
<tr>
<td>gc-interval</td>
<td>Garbage collection interval, only available when timeout or flag timeout are active</td>
<td>string, decimal followed by unit. Units are: d, h, m, s</td>
</tr>
<tr>
<td>elements</td>
<td>Elements contained by the set</td>
<td>set data type</td>
</tr>
<tr>
<td>size</td>
<td>Maximum number of elements in the set, mandatory if set is added to from the packet path (ruleset)</td>
<td>unsigned integer (64 bit)</td>
</tr>
<tr>
<td>policy</td>
<td>Set policy</td>
<td>string: performance [default], memory</td>
</tr>
<tr>
<td>auto-merge</td>
<td>Automatic merge of adjacent/overlapping set elements (only for interval sets)</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="arp-family"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7</span> ARP Family<a class="headerlink" href="#arp-family" title="Permanent link">¶</a></h2>
<h3 id="what-is-arp"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1</span> what is ARP?<a class="headerlink" href="#what-is-arp" title="Permanent link">¶</a></h3>
<p>ARP, or Address Resolution Protocol, is a communication protocol used to map IP addresses to MAC addresses within a local network segment</p>
<p>operates at the data link layer (Layer 2)</p>
<p>used for comms b/w devices on the same network</p>
<p><strong>primary purpose of ARP is to discover the MAC address of a device, on the same subnet when only its IP address is known</strong></p>
<h4 id="how-arp-works"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1.1</span> How ARP Works?<a class="headerlink" href="#how-arp-works" title="Permanent link">¶</a></h4>
<p>ARP operates using two main messages: ARP Request and ARP Reply.</p>
<h5 id="arp-request"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1.1.1</span> ARP Request:<a class="headerlink" href="#arp-request" title="Permanent link">¶</a></h5>
<p>When a device needs to send data to another device on the same subnet but only knows its IP address, it broadcasts an ARP request packet.</p>
<p>The ARP request packet contains:</p>
<ul>
<li>Sender's MAC address</li>
<li>Sender's IP address</li>
<li>Target IP address (the IP address for which the sender needs the MAC address)</li>
</ul>
<h5 id="arp-reply"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1.1.2</span> ARP Reply:<a class="headerlink" href="#arp-reply" title="Permanent link">¶</a></h5>
<p>The device that has the requested IP address responds with an ARP reply packet.</p>
<p>The ARP reply packet contains:</p>
<ul>
<li>Target's MAC address</li>
<li>Target's IP address</li>
</ul>
<p>This information is then stored in an ARP cache (or ARP table) on the requesting device for future reference. The ARP cache is a temporary table that maps IP addresses to MAC addresses.</p>
<p>
<figure><a class="glightbox" data-desc-position="bottom" data-height="auto" data-type="image" data-width="auto" href="https://media.geeksforgeeks.org/wp-content/uploads/20240212121108/How-Address-Resolution-Protocol-ARP-works---gif-opt-(1).gif"><img src="https://media.geeksforgeeks.org/wp-content/uploads/20240212121108/How-Address-Resolution-Protocol-ARP-works---gif-opt-(1).gif"/></a><figcaption>gif</figcaption>
</figure>
</p>
<h4 id="scenario"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1.2</span> Scenario<a class="headerlink" href="#scenario" title="Permanent link">¶</a></h4>
<ul>
<li>Device A wants to communicate with Device B on the same local network.</li>
<li>Device A knows Device B's IP address but not its MAC address.</li>
</ul>
<h4 id="steps"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.1.3</span> Steps<a class="headerlink" href="#steps" title="Permanent link">¶</a></h4>
<ol>
<li><strong>ARP Request</strong>: Device A broadcasts an ARP request asking "Who has IP address X.X.X.X?" to all devices on the local network.</li>
<li><strong>ARP Reply</strong>: Device B responds directly to Device A with its MAC address.</li>
<li><strong>Communication</strong>: Device A now has Device B's MAC address and can send data packets directly to Device B using this address.</li>
</ol>
<p><strong>on my laptop</strong></p>
<div class="highlight"><pre><span></span><code>arp

---
Address<span class="w">                  </span>HWtype<span class="w">  </span>HWaddress<span class="w">           </span>Flags<span class="w"> </span>Mask<span class="w">            </span>Iface
_gateway<span class="w">                 </span>ether<span class="w">   </span>bc:62:d2:1b:6c:80<span class="w">   </span>C<span class="w">                     </span>wlp3s0
phone<span class="w">                    </span>ether<span class="w">   </span><span class="m">86</span>:57:d2:45:d4:d4<span class="w">   </span>C<span class="w">                     </span>wlp3s0
<span class="m">172</span>.22.0.2<span class="w">               </span>ether<span class="w">   </span><span class="m">02</span>:42:ac:16:00:02<span class="w">   </span>C<span class="w">                     </span>br-ae907093dda2
<span class="m">192</span>.168.1.2<span class="w">              </span>ether<span class="w">   </span><span class="m">02</span>:86:40:d4:af:ef<span class="w">   </span>C<span class="w">                     </span>wlp3s0
server<span class="w">                   </span>ether<span class="w">   </span><span class="m">50</span>:b7:c3:df:a2:51<span class="w">   </span>C<span class="w">                     </span>wlp3s0
---
</code></pre></div>
<h3 id="arp-table"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.2</span> ARP Table<a class="headerlink" href="#arp-table" title="Permanent link">¶</a></h3>
<h4 id="allow-arp-requests-from-ip"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.2.1</span> allow arp requests from ip<a class="headerlink" href="#allow-arp-requests-from-ip" title="Permanent link">¶</a></h4>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>meta<span class="w"> </span>protocol<span class="w"> </span>arp<span class="w"> </span>arp<span class="w"> </span>saddr<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>accept
</code></pre></div>
<p>This rule allows ARP requests originating from IP address 192.168.1.100 to pass through the input chain of the filter table.</p>
<h4 id="block-arp-replies"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.2.2</span> block arp replies<a class="headerlink" href="#block-arp-replies" title="Permanent link">¶</a></h4>
<p><strong>to prevent arp spoofing</strong></p>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>meta<span class="w"> </span>protocol<span class="w"> </span>arp<span class="w"> </span>arp<span class="w"> </span>op<span class="w"> </span>reply<span class="w"> </span>drop
</code></pre></div>
<h4 id="allow-icmp-echo-requests-from-know-mac-only"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.2.3</span> allow ICMP echo requests from know MAC only<a class="headerlink" href="#allow-icmp-echo-requests-from-know-mac-only" title="Permanent link">¶</a></h4>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>meta<span class="w"> </span>protocol<span class="w"> </span>arp<span class="w"> </span>arp<span class="w"> </span>saddr<span class="w"> </span><span class="m">192</span>.168.1.100<span class="w"> </span>accept
nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>ip<span class="w"> </span>protocol<span class="w"> </span>icmp<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span>echo-request<span class="w"> </span>meta<span class="w"> </span>arp<span class="w"> </span>valid<span class="w"> </span>accept
</code></pre></div>
<h4 id="log-arp-requests"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.7.2.4</span> log ARP requests<a class="headerlink" href="#log-arp-requests" title="Permanent link">¶</a></h4>
<div class="highlight"><pre><span></span><code>nft<span class="w"> </span>add<span class="w"> </span>rule<span class="w"> </span>ip<span class="w"> </span>filter<span class="w"> </span>input<span class="w"> </span>meta<span class="w"> </span>protocol<span class="w"> </span>arp<span class="w"> </span>log<span class="w"> </span>prefix<span class="w"> </span><span class="s2">"ARP Request: "</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>flush<span class="w"> </span>ruleset

table<span class="w"> </span>arp<span class="w"> </span>filter<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>input<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>drop<span class="p">;</span>

<span class="w">        </span><span class="c1"># Allow ARP requests from specific MAC addresses</span>
<span class="w">        </span>arp<span class="w"> </span>saddr<span class="w"> </span>ether<span class="w"> </span>xx:xx:xx:xx:xx:xx<span class="w"> </span>arp<span class="w"> </span>op<span class="w"> </span>request<span class="w"> </span>accept
<span class="w">        </span>arp<span class="w"> </span>saddr<span class="w"> </span>ether<span class="w"> </span>yy:yy:yy:yy:yy:yy<span class="w"> </span>arp<span class="w"> </span>op<span class="w"> </span>request<span class="w"> </span>accept

<span class="w">        </span><span class="c1"># Allow ARP replies from specific MAC addresses</span>
<span class="w">        </span>arp<span class="w"> </span>saddr<span class="w"> </span>ether<span class="w"> </span>xx:xx:xx:xx:xx:xx<span class="w"> </span>arp<span class="w"> </span>op<span class="w"> </span>reply<span class="w"> </span>accept
<span class="w">        </span>arp<span class="w"> </span>saddr<span class="w"> </span>ether<span class="w"> </span>yy:yy:yy:yy:yy:yy<span class="w"> </span>arp<span class="w"> </span>op<span class="w"> </span>reply<span class="w"> </span>accept

<span class="w">        </span><span class="c1"># Drop all other ARP traffic</span>
<span class="w">        </span>drop
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>

table<span class="w"> </span>inet<span class="w"> </span>filter<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>chain<span class="w"> </span>input<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="nb">type</span><span class="w"> </span>filter<span class="w"> </span>hook<span class="w"> </span>input<span class="w"> </span>priority<span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span>policy<span class="w"> </span>drop<span class="p">;</span>

<span class="w">        </span><span class="c1"># Allow ICMP echo requests (ping) from specific MAC addresses</span>
<span class="w">        </span>ether<span class="w"> </span>saddr<span class="w"> </span>xx:xx:xx:xx:xx:xx<span class="w"> </span>ip<span class="w"> </span>protocol<span class="w"> </span>icmp<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span>echo-request<span class="w"> </span>log<span class="w"> </span>prefix<span class="w"> </span><span class="s2">"ICMP request: "</span><span class="w"> </span>accept
<span class="w">        </span>ether<span class="w"> </span>saddr<span class="w"> </span>yy:yy:yy:yy:yy:yy<span class="w"> </span>ip<span class="w"> </span>protocol<span class="w"> </span>icmp<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span>echo-request<span class="w"> </span>log<span class="w"> </span>prefix<span class="w"> </span><span class="s2">"ICMP request: "</span><span class="w"> </span>accept

<span class="w">        </span><span class="c1"># Drop all other ICMP echo requests</span>
<span class="w">        </span>ip<span class="w"> </span>protocol<span class="w"> </span>icmp<span class="w"> </span>icmp<span class="w"> </span><span class="nb">type</span><span class="w"> </span>echo-request<span class="w"> </span>drop

<span class="w">        </span><span class="c1"># Allow established and related traffic</span>
<span class="w">        </span>ct<span class="w"> </span>state<span class="w"> </span>established,related<span class="w"> </span>accept

<span class="w">        </span><span class="c1"># Drop all other traffic</span>
<span class="w">        </span>drop
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<h2 id="iptables"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.8</span> iptables<a class="headerlink" href="#iptables" title="Permanent link">¶</a></h2>
<p>has 4 <strong>tables</strong> and all tables have n <strong>chains</strong> within them &amp; you can have 7 targets on a packet <strong>accept, drop, reject, masquerade, log, dnat and snat</strong></p>
<ul>
<li><strong>filter table:</strong> this is the firewall and the default table, has 3 chains input, forward and output</li>
<li><strong>nat table:</strong> has 4 chains prerouting, input, output, and postrouing</li>
<li><strong>mangle table:</strong> has 5 chains prerouting, input, forward, output, postrouting</li>
<li><strong>raw table:</strong> has 2 chains prerouting, output</li>
</ul>
<p>iptables is part of kernel</p>
<p>Don't run both firewalld and iptables at the same time. Disable firewalld to run iptables. same goes for ufw. <strong>RUN ONLY ONE AT A TIME.</strong></p>
<ul>
<li>view current chains and rules within them for the default table <strong>filter</strong>: <code>sudo iptables -L -v --line-numbers</code> notice 3 chains INPUT, FORWARD and OUTPUT and rules within each chain</li>
<li>see the chains and rules in the <strong>nat</strong> table: <code>sudo iptables -L -t nat -v --line-numbers</code> notice 4 chains PREROUTING, INPUT, OUTPUT, POSTROUTING</li>
<li>simliary for <strong>mangle</strong> table: <code>sudo iptables -L -t nat -v --line-numbers</code> notice 5 chains</li>
<li>flush/remove all pre-existing rules: <code>sudo iptables -F -t nat</code> (by default it uses the filter table)</li>
<li><strong>NOTE:</strong> iptable rules are volatile so they go away on reboot, to save the current rules to a file and restore it later: <code>sudo iptables-save &gt; /etc/iptables/iptables.rules</code> &amp; <code>sudo iptables-restore &lt; /etc/iptables/iptables.rules</code></li>
</ul>
<h3 id="adding-rules-to-tables"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.8.1</span> adding rules to tables<a class="headerlink" href="#adding-rules-to-tables" title="Permanent link">¶</a></h3>
<ul>
<li>iptables rules are read from the top down</li>
<li>two ways to add <code>-A</code> append or <code>-I</code> insert. use append only 1 time per system and for all LATER rules use INSERT</li>
<li>append puts the rule at the bottom of the list</li>
<li>and there's only one rule we want at the very bottom: the classic DENY ALL <code>sudo iptables -A INPUT -j DROP</code> If this rule falls anywhere else in the list, nothing below it will process. -t = filter table, -A append to INPUT chain, -j target DROP</li>
<li>to allow ssh connections from all ips in /24 subnet: <code>sudo iptables -I INPUT -p tcp --dport 22 -s 192.168.1.0/24 -j ACCEPT</code> here -t = filter by default, -A is append to chain INPUT, -p protocol tcp, -dport destination port 22, -s source my ip, -j target ACCEPT</li>
<li>as i set the deny all to the bottom of my INPUT chain, <strong>any source who doesn't have my ip</strong> WILL BE BLOCKED!</li>
</ul>
<h3 id="deleting-rules"><span class="enumerate-headings-plugin enumerate-heading-plugin">1.8.2</span> deleting rules<a class="headerlink" href="#deleting-rules" title="Permanent link">¶</a></h3>
<ul>
<li>list all rules and delete 2nd rule: <code>sudo iptables -D INPUT 2</code></li>
</ul>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 22, 2024</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/dpi0" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="mailto:dpi0.dev@proton.me" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m15.24 8.998 3.656-3.073v15.81H2.482C1.11 21.735 0 20.609 0 19.223V6.944l7.58 6.38a2.186 2.186 0 0 0 2.871-.042l4.792-4.284zm-5.456 3.538 1.809-1.616a2.44 2.44 0 0 1-1.178-.533L.905 2.395A.552.552 0 0 0 0 2.826v2.811l8.226 6.923a1.186 1.186 0 0 0 1.558-.024M23.871 2.463a.55.55 0 0 0-.776-.068l-3.199 2.688v16.653h1.623c1.371 0 2.481-1.127 2.481-2.513V2.824a.55.55 0 0 0-.129-.36z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.action.view", "content.action.edit", "navigation.sections", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script src="../../js/open_in_new_tab.js"></script>
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>